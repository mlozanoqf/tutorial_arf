<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 The Gaussian copula model. | Credit risk with R.</title>
  <meta name="description" content="3 The Gaussian copula model. | Credit risk with R." />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="3 The Gaussian copula model. | Credit risk with R." />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 The Gaussian copula model. | Credit risk with R." />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="the-merton-model..html"/>
<link rel="next" href="credit-var-example-24.7..html"/>
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="loan-analysis..html"><a href="loan-analysis..html"><i class="fa fa-check"></i><b>1</b> Loan analysis.</a>
<ul>
<li class="chapter" data-level="1.1" data-path="loan-analysis..html"><a href="loan-analysis..html#explore-the-database."><i class="fa fa-check"></i><b>1.1</b> Explore the database.</a></li>
<li class="chapter" data-level="1.2" data-path="loan-analysis..html"><a href="loan-analysis..html#logistic-models."><i class="fa fa-check"></i><b>1.2</b> Logistic models.</a></li>
<li class="chapter" data-level="1.3" data-path="loan-analysis..html"><a href="loan-analysis..html#prediction-and-model-evaluation."><i class="fa fa-check"></i><b>1.3</b> Prediction and model evaluation.</a></li>
<li class="chapter" data-level="1.4" data-path="loan-analysis..html"><a href="loan-analysis..html#the-bank-strategy."><i class="fa fa-check"></i><b>1.4</b> The bank strategy.</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="the-merton-model..html"><a href="the-merton-model..html"><i class="fa fa-check"></i><b>2</b> The Merton model.</a>
<ul>
<li class="chapter" data-level="2.1" data-path="the-merton-model..html"><a href="the-merton-model..html#minimize-a-function-in-r."><i class="fa fa-check"></i><b>2.1</b> Minimize a function in R.</a></li>
<li class="chapter" data-level="2.2" data-path="the-merton-model..html"><a href="the-merton-model..html#applied-example."><i class="fa fa-check"></i><b>2.2</b> Applied example.</a></li>
<li class="chapter" data-level="2.3" data-path="the-merton-model..html"><a href="the-merton-model..html#inside-view-of-the-mertons-model."><i class="fa fa-check"></i><b>2.3</b> Inside view of the Mertonâ€™s model.</a></li>
<li class="chapter" data-level="2.4" data-path="the-merton-model..html"><a href="the-merton-model..html#the-probability-of-default-as-a-function-of-some-parameters."><i class="fa fa-check"></i><b>2.4</b> The probability of default as a function of some parameters.</a></li>
<li class="chapter" data-level="2.5" data-path="the-merton-model..html"><a href="the-merton-model..html#got-capital-structure."><i class="fa fa-check"></i><b>2.5</b> GoT: capital structure.</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html"><i class="fa fa-check"></i><b>3</b> The Gaussian copula model.</a>
<ul>
<li class="chapter" data-level="3.1" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html#the-basics."><i class="fa fa-check"></i><b>3.1</b> The basics.</a></li>
<li class="chapter" data-level="3.2" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html#introduction-to-example-24.6."><i class="fa fa-check"></i><b>3.2</b> Introduction to example 24.6.</a></li>
<li class="chapter" data-level="3.3" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html#one-firm."><i class="fa fa-check"></i><b>3.3</b> One firm.</a></li>
<li class="chapter" data-level="3.4" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html#two-firms."><i class="fa fa-check"></i><b>3.4</b> Two firms.</a></li>
<li class="chapter" data-level="3.5" data-path="the-gaussian-copula-model..html"><a href="the-gaussian-copula-model..html#ten-firms."><i class="fa fa-check"></i><b>3.5</b> Ten firms.</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="credit-var-example-24.7..html"><a href="credit-var-example-24.7..html"><i class="fa fa-check"></i><b>4</b> Credit VaR example 24.7.</a></li>
<li class="chapter" data-level="" data-path="references..html"><a href="references..html"><i class="fa fa-check"></i>References.</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Credit risk with R.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-gaussian-copula-model." class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> The Gaussian copula model.<a href="the-gaussian-copula-model..html#the-gaussian-copula-model." class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Copulas allow us to decompose a joint probability distribution into their marginals (which by definition have no correlation) and a function which couples (hence the name) them together and thus allows us to specify the correlation separately. The copula is that coupling function. Here, we introduce the simplest type of copulas into a very common problem in credit risk which is the time to default.</p>
<div id="the-basics." class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> The basics.<a href="the-gaussian-copula-model..html#the-basics." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In a finance-context, the variable <span class="math inline">\(x\)</span> represents a firmâ€™s performance measure that goes from <span class="math inline">\(-4\)</span> to <span class="math inline">\(4\)</span> in the horizontal axis. Strictly speaking, more extreme values of <span class="math inline">\(x\)</span> like <span class="math inline">\(-\infty\)</span> and <span class="math inline">\(+\infty\)</span> are theoretically possible but are very rare and happen quite infrequently at least in real-life situations. At the moment, we do not care too much about what kind of performance measure this is, it could be liquidity for example, solvency, or any other that it is normalized to have values between <span class="math inline">\(-4\)</span> and <span class="math inline">\(4\)</span>. In a statistics-context, we can think that <span class="math inline">\(x\)</span> is the so-called <span class="math inline">\(z\)</span>-score in the context of the standardized normal distribution function.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="the-gaussian-copula-model..html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The standard normal distribution function is: y = f(x).</span></span>
<span id="cb160-2"><a href="the-gaussian-copula-model..html#cb160-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">500</span>) <span class="co"># First define x.</span></span>
<span id="cb160-3"><a href="the-gaussian-copula-model..html#cb160-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x <span class="sc">^</span> <span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="co"># Define y as a function of x.</span></span>
<span id="cb160-4"><a href="the-gaussian-copula-model..html#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot.</span></span>
<span id="cb160-5"><a href="the-gaussian-copula-model..html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span> , <span class="at">ylab =</span> <span class="st">&quot;dnorm(x)&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-76"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-76-1.png" alt="Standard normal distribution function." width="672"  />
<p class="caption">
Figure 3.1: Standard normal distribution function.
</p>
</div>
<p>The copula model, including the Gaussian, considers that this performance measure <span class="math inline">\(x\)</span> in the horizontal axis is related with the firmâ€™s probability of default (from 0 to 1, or 0% to 100%). Graphically, the probability of default is represented by the area under the curve at the left of <span class="math inline">\(x\)</span>. Low values of <span class="math inline">\(x\)</span> accumulate small probabilities whereas high values of <span class="math inline">\(x\)</span> accumulate high probabilities.</p>
<p>See the following example. If <span class="math inline">\(x=3\)</span> (bad performance of a firm), then the firmâ€™s probability of default in math notation is <span class="math inline">\(N(x)\)</span>, or <span class="math inline">\(N(3)\)</span>, or <span class="math inline">\(\texttt{pnorm}(3)=0.998\)</span> in R code, which is very high as it is close to 1. On the other hand, if <span class="math inline">\(x=-3\)</span> (good performance), then the probability of default <span class="math inline">\(N(-3)\)</span> or <span class="math inline">\(\texttt{pnorm}(-3)=0.001349898\)</span> is very low as it is close to 0. Here, good performance is associated with negative values of <span class="math inline">\(x\)</span> as the accumulated probability (default probability) is low. In the same way, bad performance is related with positive <span class="math inline">\(x\)</span> values.</p>
<p>Then the R function allows us to transform <span class="math inline">\(x\)</span> into a probability of default. Transform probabilities into <span class="math inline">\(x\)</span> is also possible as the function is the inverse of . We can easily demonstrate this by retrieving the <span class="math inline">\(x\)</span> value given the probability. See for example: <span class="math inline">\(N^{-1}(0.001349898)=-3\)</span>, or in R code: <span class="math inline">\(\texttt{qnorm}(0.001349898)=-3\)</span>.</p>
<p>The function is relevant when we implement a graphical approach because it represents how frequent (or how likely) these values are given the standard normal distribution, so in both extreme values of <span class="math inline">\(x\)</span> the value of is low. Here, extreme values of <span class="math inline">\(x\)</span> can be represented by <span class="math inline">\(-4\)</span> and <span class="math inline">\(4\)</span>. This function delivers the height of the standard normal distribution, <span class="math inline">\(\texttt{dnorm}(4)=0.0001338302\)</span>, and <span class="math inline">\(\texttt{dnorm}(-4)=0.0001338302\)</span>. Given that the standard normal function is symmetrical, we have that in general: <span class="math inline">\(\texttt{dnorm}(-x)=\texttt{dnorm}(x)\)</span>. The letter <span class="math inline">\(d\)</span> in stands for density and it is maximum at <span class="math inline">\(x=0\)</span>. When plotting the density values we get the bell-shaped normal curve.</p>
<p>See how these , , R functions work and relate:</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="the-gaussian-copula-model..html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, x has 11 values only.</span></span>
<span id="cb161-2"><a href="the-gaussian-copula-model..html#cb161-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="sc">-</span><span class="dv">4</span><span class="sc">:</span><span class="dv">4</span>, <span class="cn">Inf</span>) <span class="co"># vector of x values to evaluate functions.</span></span>
<span id="cb161-3"><a href="the-gaussian-copula-model..html#cb161-3" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, <span class="fu">dnorm</span>(x), <span class="fu">pnorm</span>(x), <span class="fu">qnorm</span>(<span class="fu">pnorm</span>(x)))</span>
<span id="cb161-4"><a href="the-gaussian-copula-model..html#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;dnorm(x)=height&quot;</span>, <span class="st">&quot;pnorm(x)=pd&quot;</span>, <span class="st">&quot;qnorm(pd)=x&quot;</span>)</span>
<span id="cb161-5"><a href="the-gaussian-copula-model..html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;Review of normal distribution functions.&quot;</span>, <span class="at">digits =</span> <span class="dv">5</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-77">Table 3.1: </span>Review of normal distribution functions.</caption>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">dnorm(x)=height</th>
<th align="right">pnorm(x)=pd</th>
<th align="right">qnorm(pd)=x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-Inf</td>
<td align="right">0.00000</td>
<td align="right">0.00000</td>
<td align="right">-Inf</td>
</tr>
<tr class="even">
<td align="right">-4</td>
<td align="right">0.00013</td>
<td align="right">0.00003</td>
<td align="right">-4</td>
</tr>
<tr class="odd">
<td align="right">-3</td>
<td align="right">0.00443</td>
<td align="right">0.00135</td>
<td align="right">-3</td>
</tr>
<tr class="even">
<td align="right">-2</td>
<td align="right">0.05399</td>
<td align="right">0.02275</td>
<td align="right">-2</td>
</tr>
<tr class="odd">
<td align="right">-1</td>
<td align="right">0.24197</td>
<td align="right">0.15866</td>
<td align="right">-1</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">0.39894</td>
<td align="right">0.50000</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.24197</td>
<td align="right">0.84134</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.05399</td>
<td align="right">0.97725</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.00443</td>
<td align="right">0.99865</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.00013</td>
<td align="right">0.99997</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">Inf</td>
<td align="right">0.00000</td>
<td align="right">1.00000</td>
<td align="right">Inf</td>
</tr>
</tbody>
</table>
<p>Letâ€™s demonstrate that is maximum at <span class="math inline">\(x=0\)</span>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="the-gaussian-copula-model..html#cb162-1" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">which.max</span>(ans<span class="sc">$</span><span class="st">`</span><span class="at">dnorm(x)=height</span><span class="st">`</span>)]</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<p>You can type for example in the RStudio console to see more details about this (and other) functions.</p>
<p>Note that the only distribution function that we are currently analyzing is the standard normal (Gaussian) distribution function. A standard normal distribution function is the one that has mean 0 and variance 1. There are other copula models that assume other kinds of distributions. These other kinds of copulas are useful when we are interested in modeling cases in which extreme values are more likely to happen compared with the standard normal distribution. Understanding Gaussian copulas allows you to understand other more elaborated copulas.</p>
<p>The variable <span class="math inline">\(D\)</span> below represents the density function for the normal distribution. As we said before, the density is basically how frequent is a given value of <span class="math inline">\(x\)</span> in a normal distribution, so it helps to draw the typical bell-shape of the normal distribution function. Finally, <span class="math inline">\(P\)</span> is the cumulative probability function of the normal distribution, it is equivalent to the function <span class="math inline">\(N(\cdot)\)</span> in Mertonâ€™s model.</p>
<p>Now, letâ€™s apply the and functions for all possible values of <span class="math inline">\(x\)</span>, not only in a few (11) as we did before. This will allow us to characterize a normal distribution function graphically for all possible <span class="math inline">\(x\)</span> values. To do this, we simply create a new <span class="math inline">\(x\)</span> that has 8,001 values, that would be enough.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="the-gaussian-copula-model..html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Now, x has 8001 values, this is ok to do some continuous plots.</span></span>
<span id="cb164-2"><a href="the-gaussian-copula-model..html#cb164-2" aria-hidden="true" tabindex="-1"></a>x.theo <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="fl">0.001</span>)</span>
<span id="cb164-3"><a href="the-gaussian-copula-model..html#cb164-3" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x.theo) </span>
<span id="cb164-4"><a href="the-gaussian-copula-model..html#cb164-4" aria-hidden="true" tabindex="-1"></a>P <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x.theo)</span></code></pre></div>
<p>The red area represents the probability of default. This representation requires to calculate this area, and this can be easily done by the <span class="math inline">\(N(\cdot)\)</span> function. Graphically:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="the-gaussian-copula-model..html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, D, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb165-2"><a href="the-gaussian-copula-model..html#cb165-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density function: dnorm(x)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb165-3"><a href="the-gaussian-copula-model..html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(x.theo[x.theo <span class="sc">&lt;</span> <span class="dv">0</span>], <span class="dv">0</span>), <span class="fu">c</span>(D[x.theo <span class="sc">&lt;</span> <span class="dv">0</span>], <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb165-4"><a href="the-gaussian-copula-model..html#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Here, the red area is the </span></span>
<span id="cb165-5"><a href="the-gaussian-copula-model..html#cb165-5" aria-hidden="true" tabindex="-1"></a><span class="st">middle of the bell-shaped curve.</span></span>
<span id="cb165-6"><a href="the-gaussian-copula-model..html#cb165-6" aria-hidden="true" tabindex="-1"></a><span class="st">Smaller area means lower</span></span>
<span id="cb165-7"><a href="the-gaussian-copula-model..html#cb165-7" aria-hidden="true" tabindex="-1"></a><span class="st">probability of default.</span></span>
<span id="cb165-8"><a href="the-gaussian-copula-model..html#cb165-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-9"><a href="the-gaussian-copula-model..html#cb165-9" aria-hidden="true" tabindex="-1"></a><span class="st">The probability of default</span></span>
<span id="cb165-10"><a href="the-gaussian-copula-model..html#cb165-10" aria-hidden="true" tabindex="-1"></a><span class="st">at x=0 is N(0)=50%</span></span>
<span id="cb165-11"><a href="the-gaussian-copula-model..html#cb165-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-12"><a href="the-gaussian-copula-model..html#cb165-12" aria-hidden="true" tabindex="-1"></a><span class="st">pnorm(0)=0.5</span></span>
<span id="cb165-13"><a href="the-gaussian-copula-model..html#cb165-13" aria-hidden="true" tabindex="-1"></a><span class="st">qnorm(0.5)=0&quot;</span>),</span>
<span id="cb165-14"><a href="the-gaussian-copula-model..html#cb165-14" aria-hidden="true" tabindex="-1"></a><span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb165-15"><a href="the-gaussian-copula-model..html#cb165-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb165-16"><a href="the-gaussian-copula-model..html#cb165-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fu">dnorm</span>(<span class="dv">0</span>), <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-80"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-80-1.png" alt="The red area represents the probability of default." width="672"  />
<p class="caption">
Figure 3.2: The red area represents the probability of default.
</p>
</div>
<p>A good performing firm, with a <span class="math inline">\(x=-2\)</span>, imply a low probability of default.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="the-gaussian-copula-model..html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, D, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&quot;Density function: dnorm(x)&quot;</span>,</span>
<span id="cb166-2"><a href="the-gaussian-copula-model..html#cb166-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb166-3"><a href="the-gaussian-copula-model..html#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(x.theo[x.theo <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>], <span class="sc">-</span><span class="dv">2</span>), <span class="fu">c</span>(D[x.theo <span class="sc">&lt;</span> <span class="sc">-</span><span class="dv">2</span>], <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb166-4"><a href="the-gaussian-copula-model..html#cb166-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-5"><a href="the-gaussian-copula-model..html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Smaller area means</span></span>
<span id="cb166-6"><a href="the-gaussian-copula-model..html#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="st">lower probability of default.</span></span>
<span id="cb166-7"><a href="the-gaussian-copula-model..html#cb166-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-8"><a href="the-gaussian-copula-model..html#cb166-8" aria-hidden="true" tabindex="-1"></a><span class="st">The probability of default</span></span>
<span id="cb166-9"><a href="the-gaussian-copula-model..html#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="st">at x=-2 is N(-2)=2.275%</span></span>
<span id="cb166-10"><a href="the-gaussian-copula-model..html#cb166-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-11"><a href="the-gaussian-copula-model..html#cb166-11" aria-hidden="true" tabindex="-1"></a><span class="st">pnorm(-2)=0.02275013</span></span>
<span id="cb166-12"><a href="the-gaussian-copula-model..html#cb166-12" aria-hidden="true" tabindex="-1"></a><span class="st">qnorm(0.02275013)=-2&quot;</span>),</span>
<span id="cb166-13"><a href="the-gaussian-copula-model..html#cb166-13" aria-hidden="true" tabindex="-1"></a><span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">0.7</span>)</span>
<span id="cb166-14"><a href="the-gaussian-copula-model..html#cb166-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-81"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-81-1.png" alt="Low probability of default." width="672"  />
<p class="caption">
Figure 3.3: Low probability of default.
</p>
</div>
<p>And this is how a bankrupt firm looks like:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="the-gaussian-copula-model..html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, D, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylab =</span> <span class="st">&quot;Density function: dnorm(x)&quot;</span>,</span>
<span id="cb167-2"><a href="the-gaussian-copula-model..html#cb167-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb167-3"><a href="the-gaussian-copula-model..html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(x.theo[x.theo <span class="sc">&lt;</span> <span class="dv">4</span>], <span class="dv">4</span>), <span class="fu">c</span>(D[x.theo <span class="sc">&lt;</span> <span class="dv">4</span>], <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb167-4"><a href="the-gaussian-copula-model..html#cb167-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-5"><a href="the-gaussian-copula-model..html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;The probability of default</span></span>
<span id="cb167-6"><a href="the-gaussian-copula-model..html#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="st">at x=4 is N(4)=99.996%</span></span>
<span id="cb167-7"><a href="the-gaussian-copula-model..html#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="the-gaussian-copula-model..html#cb167-8" aria-hidden="true" tabindex="-1"></a><span class="st">pnorm(4)=0.9999683</span></span>
<span id="cb167-9"><a href="the-gaussian-copula-model..html#cb167-9" aria-hidden="true" tabindex="-1"></a><span class="st">qnorm(0.9999683)=4&quot;</span>),</span>
<span id="cb167-10"><a href="the-gaussian-copula-model..html#cb167-10" aria-hidden="true" tabindex="-1"></a><span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb167-11"><a href="the-gaussian-copula-model..html#cb167-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">4</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-82"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-82-1.png" alt="Imminent default." width="672"  />
<p class="caption">
Figure 3.4: Imminent default.
</p>
</div>
<p>Instead of a density function <span class="math inline">\(D\)</span>, we can plot the cumulative probability distribution <span class="math inline">\(P\)</span>. Now, we do not need the <span class="math inline">\(N(\cdot)\)</span> function as the vertical axis represents the probability of default.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="the-gaussian-copula-model..html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, P, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb168-2"><a href="the-gaussian-copula-model..html#cb168-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Cumulative probability function: pnorm(x)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>)</span>
<span id="cb168-3"><a href="the-gaussian-copula-model..html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="fl">0.5</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb168-4"><a href="the-gaussian-copula-model..html#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-83"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-83-1.png" alt="The higher the x, the higher the probability of default." width="672"  />
<p class="caption">
Figure 3.5: The higher the x, the higher the probability of default.
</p>
</div>
<p>Next section requires a good understanding of the example 24.6 in Hullâ€™s textbook.</p>
</div>
<div id="introduction-to-example-24.6." class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Introduction to example 24.6.<a href="the-gaussian-copula-model..html#introduction-to-example-24.6." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Here, we start analyzing Hullâ€™s example 24.6. We do not analyze the 10 firms yet as in the original example. We first make some sense about the data, the relevant analysis, the logic, and the model basics before dealing with the full features in example 24.6.</p>
<p>Recall that, leads to a probability, whereas leads to a value of <span class="math inline">\(x\)</span>. Here are some examples taken directly from the textbook example, where the cumulative probabilities of default of 1%, 3%, 6%, 10% and 15% are taken as given for the maturities of 1, 2, 3, 4 and 5 years respectively. To implement the model, we take this information to derive the corresponding <span class="math inline">\(x\)</span> values:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="the-gaussian-copula-model..html#cb169-1" aria-hidden="true" tabindex="-1"></a>pd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.03</span>, <span class="fl">0.06</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>) <span class="co"># Probabilities of default per year.</span></span>
<span id="cb169-2"><a href="the-gaussian-copula-model..html#cb169-2" aria-hidden="true" tabindex="-1"></a>x.y <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(pd) <span class="co"># Transform probabilities of default into x values.</span></span>
<span id="cb169-3"><a href="the-gaussian-copula-model..html#cb169-3" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, pd, x.y) <span class="co"># Gather the results.</span></span>
<span id="cb169-4"><a href="the-gaussian-copula-model..html#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;year&quot;</span>, <span class="st">&quot;pd&quot;</span>, <span class="st">&quot;x (values given in Hull)&quot;</span>)</span>
<span id="cb169-5"><a href="the-gaussian-copula-model..html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;Main parameters.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-84">Table 3.2: </span>Main parameters.</caption>
<thead>
<tr class="header">
<th align="right">year</th>
<th align="right">pd</th>
<th align="right">x (values given in Hull)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">0.01</td>
<td align="right">-2.326348</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">0.03</td>
<td align="right">-1.880794</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">0.06</td>
<td align="right">-1.554774</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">0.10</td>
<td align="right">-1.281552</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.15</td>
<td align="right">-1.036433</td>
</tr>
</tbody>
</table>
<p>Note that the example assumes that the probability of default increases as we consider a longer maturity (from 1 year to 5 years). Probabilities above are cumulative, so they go from year 0 to year 1, from year 0 to year 2 and so on. To calculate the probability of default during a specific year we need to calculate the differences. In particular:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="the-gaussian-copula-model..html#cb170-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">diff</span>(pd))</span>
<span id="cb170-2"><a href="the-gaussian-copula-model..html#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PD&quot;</span>)</span>
<span id="cb170-3"><a href="the-gaussian-copula-model..html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x.y1 to x.y2&quot;</span>, <span class="st">&quot;x.y2 to x.y3&quot;</span>, </span>
<span id="cb170-4"><a href="the-gaussian-copula-model..html#cb170-4" aria-hidden="true" tabindex="-1"></a>                   <span class="st">&quot;x.y3 to x.y4&quot;</span>, <span class="st">&quot;x.y4 to x.y5&quot;</span>)</span>
<span id="cb170-5"><a href="the-gaussian-copula-model..html#cb170-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;PD at specific years.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-85">Table 3.3: </span>PD at specific years.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">PD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">x.y1 to x.y2</td>
<td align="right">0.02</td>
</tr>
<tr class="even">
<td align="left">x.y2 to x.y3</td>
<td align="right">0.03</td>
</tr>
<tr class="odd">
<td align="left">x.y3 to x.y4</td>
<td align="right">0.04</td>
</tr>
<tr class="even">
<td align="left">x.y4 to x.y5</td>
<td align="right">0.05</td>
</tr>
</tbody>
</table>
<p>This is how we can illustrate the case of a probability of default of 15% in 5 years. The green area represents the 15% of the whole area below the bell-shaped curve.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="the-gaussian-copula-model..html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, D, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>),</span>
<span id="cb171-2"><a href="the-gaussian-copula-model..html#cb171-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;This could represent a firm&#39;s performance measure.</span></span>
<span id="cb171-3"><a href="the-gaussian-copula-model..html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="st">The higher, the worst performance as it accumulates more prob. of default.&quot;</span>,</span>
<span id="cb171-4"><a href="the-gaussian-copula-model..html#cb171-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Density: dnorm(x)&quot;</span>)</span>
<span id="cb171-5"><a href="the-gaussian-copula-model..html#cb171-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb171-6"><a href="the-gaussian-copula-model..html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="fu">c</span>(x.theo[x.theo <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]], x.y[<span class="dv">5</span>]), </span>
<span id="cb171-7"><a href="the-gaussian-copula-model..html#cb171-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(D[x.theo <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]], <span class="dv">0</span>), <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb171-8"><a href="the-gaussian-copula-model..html#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="the-gaussian-copula-model..html#cb171-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(</span>
<span id="cb171-10"><a href="the-gaussian-copula-model..html#cb171-10" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;pd(5years)=15%</span></span>
<span id="cb171-11"><a href="the-gaussian-copula-model..html#cb171-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-12"><a href="the-gaussian-copula-model..html#cb171-12" aria-hidden="true" tabindex="-1"></a><span class="st">The left green area</span></span>
<span id="cb171-13"><a href="the-gaussian-copula-model..html#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="st">represents 15% of the</span></span>
<span id="cb171-14"><a href="the-gaussian-copula-model..html#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="st">whole bell-shape.</span></span>
<span id="cb171-15"><a href="the-gaussian-copula-model..html#cb171-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-16"><a href="the-gaussian-copula-model..html#cb171-16" aria-hidden="true" tabindex="-1"></a><span class="st">N^-1(0.15)=-1.036433</span></span>
<span id="cb171-17"><a href="the-gaussian-copula-model..html#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="st">N(-1.036433)=0.15&quot;</span>),</span>
<span id="cb171-18"><a href="the-gaussian-copula-model..html#cb171-18" aria-hidden="true" tabindex="-1"></a><span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-86"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-86-1.png" alt="Gaussian density distribution function." width="672"  />
<p class="caption">
Figure 3.6: Gaussian density distribution function.
</p>
</div>
<p>A complementary view is the cumulative probability function. Letâ€™s illustrate the same case: a probability of default of 15% in 5 years. In this case we do not need to calculate the area since the y-axis already represents the probability.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="the-gaussian-copula-model..html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, P, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb172-2"><a href="the-gaussian-copula-model..html#cb172-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;This could represent a firm&#39;s performance measure.</span></span>
<span id="cb172-3"><a href="the-gaussian-copula-model..html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="st">The higher, the worst performance as it accumulates more prob. of default.&quot;</span>,</span>
<span id="cb172-4"><a href="the-gaussian-copula-model..html#cb172-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;N(x) is a cumulative probability&quot;</span>)</span>
<span id="cb172-5"><a href="the-gaussian-copula-model..html#cb172-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb172-6"><a href="the-gaussian-copula-model..html#cb172-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb172-7"><a href="the-gaussian-copula-model..html#cb172-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, x.y[<span class="dv">5</span>], <span class="at">length.out =</span> <span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">pnorm</span>(x.y[<span class="dv">5</span>]), <span class="dv">2</span>), </span>
<span id="cb172-8"><a href="the-gaussian-copula-model..html#cb172-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb172-9"><a href="the-gaussian-copula-model..html#cb172-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">rep</span>(x.y[<span class="dv">5</span>], <span class="dv">2</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">pnorm</span>(x.y[<span class="dv">5</span>]), <span class="at">length.out =</span> <span class="dv">2</span>), </span>
<span id="cb172-10"><a href="the-gaussian-copula-model..html#cb172-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>)</span>
<span id="cb172-11"><a href="the-gaussian-copula-model..html#cb172-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.y[<span class="dv">5</span>], <span class="fl">0.15</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb172-12"><a href="the-gaussian-copula-model..html#cb172-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;right&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(</span>
<span id="cb172-13"><a href="the-gaussian-copula-model..html#cb172-13" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;pd(5years)=15%</span></span>
<span id="cb172-14"><a href="the-gaussian-copula-model..html#cb172-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-15"><a href="the-gaussian-copula-model..html#cb172-15" aria-hidden="true" tabindex="-1"></a><span class="st">N^-1(0.15)=-1.036433</span></span>
<span id="cb172-16"><a href="the-gaussian-copula-model..html#cb172-16" aria-hidden="true" tabindex="-1"></a><span class="st">N(-1.036433)=0.15&quot;</span>),</span>
<span id="cb172-17"><a href="the-gaussian-copula-model..html#cb172-17" aria-hidden="true" tabindex="-1"></a><span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-87"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-87-1.png" alt="Gaussian probability distribution function." width="672"  />
<p class="caption">
Figure 3.7: Gaussian probability distribution function.
</p>
</div>
<p>A closer view to the figure above to see the 3-year and 5-year cases:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="the-gaussian-copula-model..html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.theo, P, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&#39;black&#39;</span>, <span class="at">lwd =</span> <span class="dv">5</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.22</span>), </span>
<span id="cb173-2"><a href="the-gaussian-copula-model..html#cb173-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>), <span class="at">ylab =</span> <span class="st">&quot;N(x) is a cumulative probability&quot;</span>,</span>
<span id="cb173-3"><a href="the-gaussian-copula-model..html#cb173-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;This could represent a firm&#39;s performance measure.</span></span>
<span id="cb173-4"><a href="the-gaussian-copula-model..html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="st">The higher, the worst performance as it accumulates more prob. of default.&quot;</span>)</span>
<span id="cb173-5"><a href="the-gaussian-copula-model..html#cb173-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-6"><a href="the-gaussian-copula-model..html#cb173-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-7"><a href="the-gaussian-copula-model..html#cb173-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, x.y[<span class="dv">3</span>], <span class="at">length.out=</span> <span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">pnorm</span>(x.y[<span class="dv">3</span>]), <span class="dv">2</span>), </span>
<span id="cb173-8"><a href="the-gaussian-copula-model..html#cb173-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-9"><a href="the-gaussian-copula-model..html#cb173-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">rep</span>(x.y[<span class="dv">3</span>], <span class="dv">2</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">pnorm</span>(x.y[<span class="dv">3</span>]), <span class="at">length.out =</span> <span class="dv">2</span>), </span>
<span id="cb173-10"><a href="the-gaussian-copula-model..html#cb173-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-11"><a href="the-gaussian-copula-model..html#cb173-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, x.y[<span class="dv">5</span>], <span class="at">length.out =</span> <span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">pnorm</span>(x.y[<span class="dv">5</span>]), <span class="dv">2</span>), </span>
<span id="cb173-12"><a href="the-gaussian-copula-model..html#cb173-12" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-13"><a href="the-gaussian-copula-model..html#cb173-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">rep</span>(x.y[<span class="dv">5</span>], <span class="dv">2</span>), <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">pnorm</span>(x.y[<span class="dv">5</span>]), <span class="at">length.out =</span> <span class="dv">2</span>), </span>
<span id="cb173-14"><a href="the-gaussian-copula-model..html#cb173-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb173-15"><a href="the-gaussian-copula-model..html#cb173-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.y[<span class="dv">3</span>], <span class="fl">0.06</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb173-16"><a href="the-gaussian-copula-model..html#cb173-16" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x.y[<span class="dv">5</span>], <span class="fl">0.15</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">cex =</span> <span class="dv">2</span>)</span>
<span id="cb173-17"><a href="the-gaussian-copula-model..html#cb173-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;pd(5years)=15%: N(-1.036433)=0.15&quot;</span>,</span>
<span id="cb173-18"><a href="the-gaussian-copula-model..html#cb173-18" aria-hidden="true" tabindex="-1"></a>                           <span class="st">&quot;pd(3years)=6%: N(-1.554774)=0.06&quot;</span>),</span>
<span id="cb173-19"><a href="the-gaussian-copula-model..html#cb173-19" aria-hidden="true" tabindex="-1"></a><span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;purple&quot;</span>), <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, <span class="at">cex =</span> <span class="dv">1</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-88"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-88-1.png" alt="Gaussian probability distribution function: Zoom version." width="672"  />
<p class="caption">
Figure 3.8: Gaussian probability distribution function: Zoom version.
</p>
</div>
<p>The Gaussian copula approach is a method that takes the Gaussian distribution function to match the credit risk profile of firms.</p>
</div>
<div id="one-firm." class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> One firm.<a href="the-gaussian-copula-model..html#one-firm." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now letâ€™s use a simulation approach instead of a theoretical approach. This is, instead of generating continuous values of <span class="math inline">\(x\)</span> from <span class="math inline">\(-4\)</span> to <span class="math inline">\(4\)</span>, we simulate many <span class="math inline">\(x\)</span> values (10,000 in this case) that follow a standard normal distribution function using the function. The simulation approach is useful especially when we are interested in replicating what happens in real-life situations because we can replicate the observed distribution many times and this facilitates the analysis. In other words, was used before to characterize a <em>perfect</em> normal distribution. Now, we incorporate that behaves as a normal distribution. These are now simulated values that follow a normal distribution, this means that we allow for some error or deviation with respect to the <em>perfect</em> normal distribution analyzed before.</p>
<p>Note that the probabilities of default per maturity in the simulated approach are close to the values of the previous section. In particular, <span class="math inline">\(0.01\)</span> is equivalent to <span class="math inline">\(0.0102\)</span>, and <span class="math inline">\(0.03\)</span> is equivalent to <span class="math inline">\(0.0307\)</span>. They do not match exactly simply because we are comparing theoretical versus simulated probabilities.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="the-gaussian-copula-model..html#cb174-1" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># Number of simulated values.</span></span>
<span id="cb174-2"><a href="the-gaussian-copula-model..html#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>) <span class="co"># Reproducibility.</span></span>
<span id="cb174-3"><a href="the-gaussian-copula-model..html#cb174-3" aria-hidden="true" tabindex="-1"></a>x.sim <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N, <span class="dv">0</span>, <span class="dv">1</span>) <span class="co"># Simulation.</span></span></code></pre></div>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="the-gaussian-copula-model..html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate proportions that we understand as probabilities.</span></span>
<span id="cb175-2"><a href="the-gaussian-copula-model..html#cb175-2" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb175-3"><a href="the-gaussian-copula-model..html#cb175-3" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> <span class="fu">length</span>(x.sim[x.sim <span class="sc">&lt;=</span> x]) <span class="sc">/</span> N</span>
<span id="cb175-4"><a href="the-gaussian-copula-model..html#cb175-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb175-5"><a href="the-gaussian-copula-model..html#cb175-5" aria-hidden="true" tabindex="-1"></a>pd.sim <span class="ot">&lt;-</span> <span class="fu">mapply</span>(prop, x.y) <span class="co"># Apply the function.</span></span>
<span id="cb175-6"><a href="the-gaussian-copula-model..html#cb175-6" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x.y, pd, pd.sim)</span>
<span id="cb175-7"><a href="the-gaussian-copula-model..html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;pd.theo&quot;</span>, <span class="st">&quot;pd.sim&quot;</span>)</span>
<span id="cb175-8"><a href="the-gaussian-copula-model..html#cb175-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;y1&quot;</span>, <span class="st">&quot;y2&quot;</span>, <span class="st">&quot;y3&quot;</span>, <span class="st">&quot;y4&quot;</span>, <span class="st">&quot;y5&quot;</span>)</span>
<span id="cb175-9"><a href="the-gaussian-copula-model..html#cb175-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;Theoretic versus simulated probabilities of default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-90">Table 3.4: </span>Theoretic versus simulated probabilities of default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
<th align="right">pd.theo</th>
<th align="right">pd.sim</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">y1</td>
<td align="right">-2.326348</td>
<td align="right">0.01</td>
<td align="right">0.0102</td>
</tr>
<tr class="even">
<td align="left">y2</td>
<td align="right">-1.880794</td>
<td align="right">0.03</td>
<td align="right">0.0307</td>
</tr>
<tr class="odd">
<td align="left">y3</td>
<td align="right">-1.554774</td>
<td align="right">0.06</td>
<td align="right">0.0629</td>
</tr>
<tr class="even">
<td align="left">y4</td>
<td align="right">-1.281552</td>
<td align="right">0.10</td>
<td align="right">0.1008</td>
</tr>
<tr class="odd">
<td align="left">y5</td>
<td align="right">-1.036433</td>
<td align="right">0.15</td>
<td align="right">0.1480</td>
</tr>
</tbody>
</table>
<p>Letâ€™s view the results of the simulated approach. First in a histogram.</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="the-gaussian-copula-model..html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Some parameters we need to plot.</span></span>
<span id="cb176-2"><a href="the-gaussian-copula-model..html#cb176-2" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>) <span class="co"># axis limits.</span></span>
<span id="cb176-3"><a href="the-gaussian-copula-model..html#cb176-3" aria-hidden="true" tabindex="-1"></a>colors2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;purple&quot;</span>, <span class="st">&quot;pink&quot;</span>, <span class="st">&quot;green&quot;</span>)</span>
<span id="cb176-4"><a href="the-gaussian-copula-model..html#cb176-4" aria-hidden="true" tabindex="-1"></a>legend2 <span class="ot">=</span> <span class="fu">c</span>(<span class="st">&quot;pd(1year)=1.02%: x&lt;=-2.326348&quot;</span>, </span>
<span id="cb176-5"><a href="the-gaussian-copula-model..html#cb176-5" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;pd(2years)=3.07%: x&lt;=-1.880794&quot;</span>, <span class="st">&quot;pd(3years)=6.29%: x&lt;=-1.554774&quot;</span>,</span>
<span id="cb176-6"><a href="the-gaussian-copula-model..html#cb176-6" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;pd(4years)=10.08%: x&lt;=-1.281552&quot;</span>, <span class="st">&quot;pd(5years)=14.8%: x&lt;=-1.036433&quot;</span>)</span>
<span id="cb176-7"><a href="the-gaussian-copula-model..html#cb176-7" aria-hidden="true" tabindex="-1"></a><span class="co"># The histogram.</span></span>
<span id="cb176-8"><a href="the-gaussian-copula-model..html#cb176-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(x.sim, <span class="dv">500</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">100</span>), <span class="at">main =</span> <span class="cn">NULL</span>, <span class="at">xlab =</span> <span class="st">&quot;x</span></span>
<span id="cb176-9"><a href="the-gaussian-copula-model..html#cb176-9" aria-hidden="true" tabindex="-1"></a><span class="st">This could represent a firm&#39;s simulated performance measure&quot;</span>)</span>
<span id="cb176-10"><a href="the-gaussian-copula-model..html#cb176-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb176-11"><a href="the-gaussian-copula-model..html#cb176-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb176-12"><a href="the-gaussian-copula-model..html#cb176-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">2</span>], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb176-13"><a href="the-gaussian-copula-model..html#cb176-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">3</span>], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb176-14"><a href="the-gaussian-copula-model..html#cb176-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>)</span>
<span id="cb176-15"><a href="the-gaussian-copula-model..html#cb176-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lwd =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb176-16"><a href="the-gaussian-copula-model..html#cb176-16" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> legend2, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb176-17"><a href="the-gaussian-copula-model..html#cb176-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> colors2, <span class="at">cex =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-91-1.png" alt="Simulated Gaussian probability distribution function. Somewhat different with respect to the theoretical." width="672"  />
<p class="caption">
Figure 3.9: Simulated Gaussian probability distribution function. Somewhat different with respect to the theoretical.
</p>
</div>
<p>The area at the left hand side of each colored line represents the cumulative probability of default just as we explained before. In the same way, the area between two colored lines represents the probability of default in a specific period of time.</p>
<p>Now letâ€™s see all the simulated data at once.</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="the-gaussian-copula-model..html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x.sim, <span class="at">ylab =</span> <span class="st">&quot;One firm performance&quot;</span>, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, </span>
<span id="cb177-2"><a href="the-gaussian-copula-model..html#cb177-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">7</span>),</span>
<span id="cb177-3"><a href="the-gaussian-copula-model..html#cb177-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;10,000 simulated performance data&quot;</span>)</span>
<span id="cb177-4"><a href="the-gaussian-copula-model..html#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">1</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb177-5"><a href="the-gaussian-copula-model..html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">2</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb177-6"><a href="the-gaussian-copula-model..html#cb177-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">3</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb177-7"><a href="the-gaussian-copula-model..html#cb177-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">4</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;pink&quot;</span>)</span>
<span id="cb177-8"><a href="the-gaussian-copula-model..html#cb177-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>)</span>
<span id="cb177-9"><a href="the-gaussian-copula-model..html#cb177-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb177-10"><a href="the-gaussian-copula-model..html#cb177-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">10000</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb177-11"><a href="the-gaussian-copula-model..html#cb177-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> legend2, <span class="at">bg =</span> <span class="st">&quot;white&quot;</span>, </span>
<span id="cb177-12"><a href="the-gaussian-copula-model..html#cb177-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">text.col =</span> colors2, <span class="at">cex =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-92"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-92-1.png" alt="An alternative view." width="672"  />
<p class="caption">
Figure 3.10: An alternative view.
</p>
</div>
<p>We normally conduct a simulation approach because we might adapt the distribution function parameters to match what we see in the real life situations. The simulation approach allows us to have such flexibility.</p>
</div>
<div id="two-firms." class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Two firms.<a href="the-gaussian-copula-model..html#two-firms." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now consider the case in which we have two firms instead of one. The main difference now is that instead of simulating one firm we need two. Moreover, each firm follows a standard normal distribution function and both of them are correlated by a given correlation value so the firms are not independent. If they are not independent, then what happens to one firm has some impact on what happens to the other. In this case, we assume 0.2 as a correlation value. The case of two firms is not the one presented in Hullâ€™s example but it can help us to visualize how the Gaussian copula approach works in a two-dimension plot.</p>
<p>The simulation of both firmsâ€™ performance measures is .</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="the-gaussian-copula-model..html#cb178-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># number of firms</span></span>
<span id="cb178-2"><a href="the-gaussian-copula-model..html#cb178-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of simulations</span></span>
<span id="cb178-3"><a href="the-gaussian-copula-model..html#cb178-3" aria-hidden="true" tabindex="-1"></a>rho_pos02 <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># correlation</span></span>
<span id="cb178-4"><a href="the-gaussian-copula-model..html#cb178-4" aria-hidden="true" tabindex="-1"></a>corr_pos02 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(rho_pos02, m <span class="sc">*</span> m), m, m) <span class="co"># correlation matrix</span></span>
<span id="cb178-5"><a href="the-gaussian-copula-model..html#cb178-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_pos02) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb178-6"><a href="the-gaussian-copula-model..html#cb178-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb178-7"><a href="the-gaussian-copula-model..html#cb178-7" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> corr_pos02)</span>
<span id="cb178-8"><a href="the-gaussian-copula-model..html#cb178-8" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x2)</span>
<span id="cb178-9"><a href="the-gaussian-copula-model..html#cb178-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(x2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Firm1&quot;</span>, <span class="st">&quot;Firm2&quot;</span>)</span></code></pre></div>
<p>The matrix length is 10,000 for each firm. In other words, we have 10,000 observations of the performance measure or <span class="math inline">\(z\)</span>-score for two firms that are related. This matrix is big, but we can visualize the header (the first six observations).</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="the-gaussian-copula-model..html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(x2), <span class="at">caption =</span> <span class="st">&quot;Firm&#39;s performance.&quot;</span>, <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-94">Table 3.5: </span>Firmâ€™s performance.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.0880039</td>
<td align="right">-2.8671108</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.0092849</td>
<td align="right">-1.1735732</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">0.0323809</td>
<td align="right">-0.5854275</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">1.5547886</td>
<td align="right">-0.0630241</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">0.9679767</td>
<td align="right">-0.3977597</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">0.7751329</td>
<td align="right">0.8847116</td>
</tr>
</tbody>
</table>
<p>Remember the cumulative probabilities of default are 1%, 3%, 6%, 10% and 15% for the maturities of 1, 2, 3, 4 and 5 years respectively. How do we extract those cases in which both firms will default in 5 years? In rows 15, 53, 61 and so on both firms default at the same time. Note that in all cases the <span class="math inline">\(x\)</span> values are indeed below -1.036433.</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="the-gaussian-copula-model..html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These names are going to be useful later.</span></span>
<span id="cb180-2"><a href="the-gaussian-copula-model..html#cb180-2" aria-hidden="true" tabindex="-1"></a>n.year <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;year 1&quot;</span>, <span class="st">&quot;year 2&quot;</span>, <span class="st">&quot;year 3&quot;</span>, <span class="st">&quot;year 4&quot;</span>, <span class="st">&quot;year 5&quot;</span>)</span>
<span id="cb180-3"><a href="the-gaussian-copula-model..html#cb180-3" aria-hidden="true" tabindex="-1"></a>n.pd <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pd.y1&quot;</span>, <span class="st">&quot;pd.y2&quot;</span>, <span class="st">&quot;pd.y3&quot;</span>, <span class="st">&quot;pd.y4&quot;</span>, <span class="st">&quot;pd.y5&quot;</span>)</span>
<span id="cb180-4"><a href="the-gaussian-copula-model..html#cb180-4" aria-hidden="true" tabindex="-1"></a>n.f <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Firm1&quot;</span>, <span class="st">&quot;Firm2&quot;</span>, <span class="st">&quot;Firm1 default?&quot;</span>, <span class="st">&quot;Firm2 default?&quot;</span>)</span>
<span id="cb180-5"><a href="the-gaussian-copula-model..html#cb180-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb180-6"><a href="the-gaussian-copula-model..html#cb180-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate cases in which firms default and probabilities.</span></span>
<span id="cb180-7"><a href="the-gaussian-copula-model..html#cb180-7" aria-hidden="true" tabindex="-1"></a>fun.X <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb180-8"><a href="the-gaussian-copula-model..html#cb180-8" aria-hidden="true" tabindex="-1"></a>  both <span class="ot">&lt;-</span> x2[x2<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ] <span class="co"># both default.</span></span>
<span id="cb180-9"><a href="the-gaussian-copula-model..html#cb180-9" aria-hidden="true" tabindex="-1"></a>  atleast1 <span class="ot">&lt;-</span> x2[x2<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">|</span> x2<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ] <span class="co"># at least one firm default.</span></span>
<span id="cb180-10"><a href="the-gaussian-copula-model..html#cb180-10" aria-hidden="true" tabindex="-1"></a>  onlyfirm1 <span class="ot">&lt;-</span> x2[x2<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ] <span class="co"># only firm 1 default.</span></span>
<span id="cb180-11"><a href="the-gaussian-copula-model..html#cb180-11" aria-hidden="true" tabindex="-1"></a>  onlyfirm2 <span class="ot">&lt;-</span> x2[x2<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x, ] <span class="co"># only firm 2 default.</span></span>
<span id="cb180-12"><a href="the-gaussian-copula-model..html#cb180-12" aria-hidden="true" tabindex="-1"></a>  onlyone <span class="ot">&lt;-</span> x2[(x2<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">|</span> <span class="co"># only one firm default.</span></span>
<span id="cb180-13"><a href="the-gaussian-copula-model..html#cb180-13" aria-hidden="true" tabindex="-1"></a>                   x2<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x),]</span>
<span id="cb180-14"><a href="the-gaussian-copula-model..html#cb180-14" aria-hidden="true" tabindex="-1"></a>  none <span class="ot">&lt;-</span> x2[x2<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> x2<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x, ] <span class="co"># no firm default.</span></span>
<span id="cb180-15"><a href="the-gaussian-copula-model..html#cb180-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Gather results and probabilities in a list.</span></span>
<span id="cb180-16"><a href="the-gaussian-copula-model..html#cb180-16" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">both =</span> both, <span class="at">atleast1 =</span> atleast1, <span class="at">onlyfirm1 =</span> onlyfirm1,</span>
<span id="cb180-17"><a href="the-gaussian-copula-model..html#cb180-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm2 =</span> onlyfirm2, <span class="at">onlyone =</span> onlyone, <span class="at">none =</span> none,</span>
<span id="cb180-18"><a href="the-gaussian-copula-model..html#cb180-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">both.pd =</span> (<span class="fu">nrow</span>(both) <span class="sc">/</span> n), <span class="at">atleast1.pd =</span> (<span class="fu">nrow</span>(atleast1) <span class="sc">/</span> n),</span>
<span id="cb180-19"><a href="the-gaussian-copula-model..html#cb180-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm1.pd =</span> (<span class="fu">nrow</span>(onlyfirm1) <span class="sc">/</span> n), <span class="at">onlyfirm2.pd =</span> (<span class="fu">nrow</span>(onlyfirm2)<span class="sc">/</span> n),</span>
<span id="cb180-20"><a href="the-gaussian-copula-model..html#cb180-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyone.pd =</span> (<span class="fu">nrow</span>(onlyone) <span class="sc">/</span> n), <span class="at">none.pd =</span> (<span class="fu">nrow</span>(none) <span class="sc">/</span> n))</span>
<span id="cb180-21"><a href="the-gaussian-copula-model..html#cb180-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb180-22"><a href="the-gaussian-copula-model..html#cb180-22" aria-hidden="true" tabindex="-1"></a><span class="co"># X has all the relevant results for x2.</span></span>
<span id="cb180-23"><a href="the-gaussian-copula-model..html#cb180-23" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fun.X, x.y)</span></code></pre></div>
<p>See the cases in which both firms default in 5 years.</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="the-gaussian-copula-model..html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract &quot;both&quot; cases, year 5.</span></span>
<span id="cb181-2"><a href="the-gaussian-copula-model..html#cb181-2" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb181-3"><a href="the-gaussian-copula-model..html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(both) <span class="ot">&lt;-</span> n.f</span>
<span id="cb181-4"><a href="the-gaussian-copula-model..html#cb181-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(both), <span class="at">caption =</span> <span class="st">&quot;Cases in which both firms default in 5 years.&quot;</span>, </span>
<span id="cb181-5"><a href="the-gaussian-copula-model..html#cb181-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-96">Table 3.6: </span>Cases in which both firms default in 5 years.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">15</td>
<td align="right">-1.123330</td>
<td align="right">-1.783569</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">53</td>
<td align="right">-2.724912</td>
<td align="right">-1.235614</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">61</td>
<td align="right">-1.968789</td>
<td align="right">-1.516563</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">108</td>
<td align="right">-2.121617</td>
<td align="right">-1.807062</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">156</td>
<td align="right">-1.559930</td>
<td align="right">-1.132879</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">157</td>
<td align="right">-1.194204</td>
<td align="right">-2.120824</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>In total, we have 343 cases in which both firms default at the same time. The first case is number 15, the second 53, the third 61 and so on. It is easy to know the total cases if we count the number of rows.</p>
<p>How do we extract those cases in which at least one firm will default in 5 years? This is, only firm 1, only firm 2 and even both at the same time. This is a less strict condition so we would expect to have more cases to match this new criteria compared with . Note that in all cases at least one one firm is indeed below -1.036433. In row 1, 2 and 10 firm 2 defaults. In row 15 both firms default. In row 18 and 20 firm 1 and firm 2 default respectively.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="the-gaussian-copula-model..html#cb182-1" aria-hidden="true" tabindex="-1"></a>atleast1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;atleast1&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;atleast1&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb182-2"><a href="the-gaussian-copula-model..html#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(atleast1) <span class="ot">&lt;-</span> n.f</span>
<span id="cb182-3"><a href="the-gaussian-copula-model..html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(atleast1), <span class="at">caption =</span> <span class="st">&quot;Cases in which at least one firm default.&quot;</span>, </span>
<span id="cb182-4"><a href="the-gaussian-copula-model..html#cb182-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-97">Table 3.7: </span>Cases in which at least one firm default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.0880039</td>
<td align="right">-2.8671108</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.0092849</td>
<td align="right">-1.1735732</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">1.4475216</td>
<td align="right">-1.1512274</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">15</td>
<td align="right">-1.1233296</td>
<td align="right">-1.7835692</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">18</td>
<td align="right">-1.5829965</td>
<td align="right">-0.7174298</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="right">-0.9221666</td>
<td align="right">-1.9982869</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Now we have 2,660 cases. Considerably more as the | restriction is less strict than the &amp;. Letâ€™s see the cases in which only firm 1 defaults.</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="the-gaussian-copula-model..html#cb183-1" aria-hidden="true" tabindex="-1"></a>onlyfirm1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb183-2"><a href="the-gaussian-copula-model..html#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(onlyfirm1) <span class="ot">&lt;-</span> n.f</span>
<span id="cb183-3"><a href="the-gaussian-copula-model..html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(onlyfirm1), <span class="at">caption =</span> <span class="st">&quot;Cases in which only firm 1 default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-98">Table 3.8: </span>Cases in which only firm 1 default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">18</td>
<td align="right">-1.582996</td>
<td align="right">-0.7174298</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">34</td>
<td align="right">-2.842355</td>
<td align="right">1.5400020</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">35</td>
<td align="right">-2.090320</td>
<td align="right">0.7431275</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">36</td>
<td align="right">-1.600142</td>
<td align="right">0.3082653</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">41</td>
<td align="right">-2.193496</td>
<td align="right">-0.8465008</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">49</td>
<td align="right">-1.764711</td>
<td align="right">-0.3914202</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Only firm 2 defaults.</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="the-gaussian-copula-model..html#cb184-1" aria-hidden="true" tabindex="-1"></a>onlyfirm2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb184-2"><a href="the-gaussian-copula-model..html#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(onlyfirm2) <span class="ot">&lt;-</span> n.f</span>
<span id="cb184-3"><a href="the-gaussian-copula-model..html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(onlyfirm2), <span class="at">caption =</span> <span class="st">&quot;Cases in which only firm 2 default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-99">Table 3.9: </span>Cases in which only firm 2 default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.0880039</td>
<td align="right">-2.867111</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.0092849</td>
<td align="right">-1.173573</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">1.4475216</td>
<td align="right">-1.151227</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="right">-0.9221666</td>
<td align="right">-1.998287</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">22</td>
<td align="right">-0.1110555</td>
<td align="right">-1.348605</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">40</td>
<td align="right">0.1058949</td>
<td align="right">-1.752620</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Only one firm default at year 5.</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="the-gaussian-copula-model..html#cb185-1" aria-hidden="true" tabindex="-1"></a>onlyone <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;onlyone&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;onlyone&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb185-2"><a href="the-gaussian-copula-model..html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(onlyone) <span class="ot">&lt;-</span> n.f</span>
<span id="cb185-3"><a href="the-gaussian-copula-model..html#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(onlyone), <span class="at">caption =</span> <span class="st">&quot;Cases in which only one firm default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-100">Table 3.10: </span>Cases in which only one firm default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">0.0880039</td>
<td align="right">-2.8671108</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">0.0092849</td>
<td align="right">-1.1735732</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">10</td>
<td align="right">1.4475216</td>
<td align="right">-1.1512274</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">18</td>
<td align="right">-1.5829965</td>
<td align="right">-0.7174298</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="right">-0.9221666</td>
<td align="right">-1.9982869</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">22</td>
<td align="right">-0.1110555</td>
<td align="right">-1.3486051</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>Lastly, when no firm defaults.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="the-gaussian-copula-model..html#cb186-1" aria-hidden="true" tabindex="-1"></a>none <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], X[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]] <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])</span>
<span id="cb186-2"><a href="the-gaussian-copula-model..html#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(none) <span class="ot">&lt;-</span> n.f</span>
<span id="cb186-3"><a href="the-gaussian-copula-model..html#cb186-3" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(none), <span class="at">caption =</span> <span class="st">&quot;Cases in which no firm default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-101">Table 3.11: </span>Cases in which no firm default.</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Firm1</th>
<th align="right">Firm2</th>
<th align="left">Firm1 default?</th>
<th align="left">Firm2 default?</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3</td>
<td align="right">0.0323809</td>
<td align="right">-0.5854275</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">1.5547886</td>
<td align="right">-0.0630241</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">5</td>
<td align="right">0.9679767</td>
<td align="right">-0.3977597</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">6</td>
<td align="right">0.7751329</td>
<td align="right">0.8847116</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">7</td>
<td align="right">1.3361498</td>
<td align="right">1.0392145</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="right">1.3039572</td>
<td align="right">1.5191303</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>Finally, probabilities.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="the-gaussian-copula-model..html#cb187-1" aria-hidden="true" tabindex="-1"></a>both.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;both.pd&quot;</span>,]))</span>
<span id="cb187-2"><a href="the-gaussian-copula-model..html#cb187-2" aria-hidden="true" tabindex="-1"></a>atleast1.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;atleast1.pd&quot;</span>,]))</span>
<span id="cb187-3"><a href="the-gaussian-copula-model..html#cb187-3" aria-hidden="true" tabindex="-1"></a>onlyfirm1.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;onlyfirm1.pd&quot;</span>,]))</span>
<span id="cb187-4"><a href="the-gaussian-copula-model..html#cb187-4" aria-hidden="true" tabindex="-1"></a>onlyfirm2.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;onlyfirm2.pd&quot;</span>,]))</span>
<span id="cb187-5"><a href="the-gaussian-copula-model..html#cb187-5" aria-hidden="true" tabindex="-1"></a>onlyone.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;onlyone.pd&quot;</span>,]))</span>
<span id="cb187-6"><a href="the-gaussian-copula-model..html#cb187-6" aria-hidden="true" tabindex="-1"></a>none.pd <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(X[<span class="st">&quot;none.pd&quot;</span>,]))</span>
<span id="cb187-7"><a href="the-gaussian-copula-model..html#cb187-7" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(both.pd, atleast1.pd, onlyfirm1.pd, onlyfirm2.pd, </span>
<span id="cb187-8"><a href="the-gaussian-copula-model..html#cb187-8" aria-hidden="true" tabindex="-1"></a>                 onlyone.pd, none.pd)</span>
<span id="cb187-9"><a href="the-gaussian-copula-model..html#cb187-9" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans) <span class="ot">&lt;-</span> n.year</span>
<span id="cb187-10"><a href="the-gaussian-copula-model..html#cb187-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;Probabilities of default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-102">Table 3.12: </span>Probabilities of default.</caption>
<colgroup>
<col width="9%" />
<col width="11%" />
<col width="16%" />
<col width="18%" />
<col width="18%" />
<col width="15%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">both.pd</th>
<th align="right">atleast1.pd</th>
<th align="right">onlyfirm1.pd</th>
<th align="right">onlyfirm2.pd</th>
<th align="right">onlyone.pd</th>
<th align="right">none.pd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year 1</td>
<td align="right">0.0003</td>
<td align="right">0.0192</td>
<td align="right">0.0103</td>
<td align="right">0.0086</td>
<td align="right">0.0189</td>
<td align="right">0.9808</td>
</tr>
<tr class="even">
<td align="left">year 2</td>
<td align="right">0.0019</td>
<td align="right">0.0560</td>
<td align="right">0.0282</td>
<td align="right">0.0259</td>
<td align="right">0.0541</td>
<td align="right">0.9440</td>
</tr>
<tr class="odd">
<td align="left">year 3</td>
<td align="right">0.0066</td>
<td align="right">0.1141</td>
<td align="right">0.0561</td>
<td align="right">0.0514</td>
<td align="right">0.1075</td>
<td align="right">0.8859</td>
</tr>
<tr class="even">
<td align="left">year 4</td>
<td align="right">0.0176</td>
<td align="right">0.1854</td>
<td align="right">0.0864</td>
<td align="right">0.0814</td>
<td align="right">0.1678</td>
<td align="right">0.8146</td>
</tr>
<tr class="odd">
<td align="left">year 5</td>
<td align="right">0.0343</td>
<td align="right">0.2660</td>
<td align="right">0.1210</td>
<td align="right">0.1107</td>
<td align="right">0.2317</td>
<td align="right">0.7340</td>
</tr>
</tbody>
</table>
<p>So interesting.</p>
<p>Note that 15% is the theoretical probability that one firm will default in 5 years. Here, this 15% is 12.1% for firm 1 and 11.07% for firm 2 when the data is simulated.</p>
<p>We can even perform a nice test to see that everything is alright. For example, this equation must hold: . Substituting for the year 5: <span class="math inline">\(0.121+0.1107=0.2317\)</span>. As you can see, everything is alright. This equation must hold as well: . Substituting for the year 5: <span class="math inline">\(0.266-0.0343=0.2317\)</span>. As you can see, everything is alright.</p>
<p>Letâ€™s visualize all 10,000 cases. Each dot represents a couple of Firm1 and Firm2 <span class="math inline">\(x\)</span> values and the dotted lines the threshold that represents the probability of default in 5 years.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="the-gaussian-copula-model..html#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>) <span class="co"># Figures are shown in a perfect square (not a rectangle).</span></span>
<span id="cb188-2"><a href="the-gaussian-copula-model..html#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>) </span>
<span id="cb188-3"><a href="the-gaussian-copula-model..html#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">mean</span>(x2[,<span class="dv">1</span>]), <span class="fu">mean</span>(x2[,<span class="dv">2</span>]), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="dv">1</span>)</span>
<span id="cb188-4"><a href="the-gaussian-copula-model..html#cb188-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb188-5"><a href="the-gaussian-copula-model..html#cb188-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb188-6"><a href="the-gaussian-copula-model..html#cb188-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(<span class="fu">nrow</span>(x2))), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-103-1.png" alt="All 10,000 simulated cases." width="672"  />
<p class="caption">
Figure 3.11: All 10,000 simulated cases.
</p>
</div>
<p>These 10,000 observations are highly concentrated around the mean which is very close to zero <span class="math inline">\((-0.01883215,-0.0147721)\)</span>, note the red point. This can be also easily seen in the following density plot.</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="the-gaussian-copula-model..html#cb189-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(x2)</span>
<span id="cb189-2"><a href="the-gaussian-copula-model..html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb189-3"><a href="the-gaussian-copula-model..html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> x2<span class="sc">$</span>Firm1, <span class="at">y =</span> x2<span class="sc">$</span>Firm2)) <span class="sc">+</span></span>
<span id="cb189-4"><a href="the-gaussian-copula-model..html#cb189-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density2d</span>(<span class="fu">aes</span>(<span class="at">fill =</span> ..density..), <span class="at">contour =</span> F, </span>
<span id="cb189-5"><a href="the-gaussian-copula-model..html#cb189-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">geom =</span> <span class="st">&#39;tile&#39;</span>) <span class="sc">+</span></span>
<span id="cb189-6"><a href="the-gaussian-copula-model..html#cb189-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_viridis</span>()<span class="sc">+</span></span>
<span id="cb189-7"><a href="the-gaussian-copula-model..html#cb189-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_fixed</span>()</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-104"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-104-1.png" alt="All 10,000 simulated cases: A density view." width="672"  />
<p class="caption">
Figure 3.12: All 10,000 simulated cases: A density view.
</p>
</div>
<p>We can visualize the default cases. First, the case when both firms default at year 5.</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="the-gaussian-copula-model..html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb190-2"><a href="the-gaussian-copula-model..html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim  =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>) </span>
<span id="cb190-3"><a href="the-gaussian-copula-model..html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb190-4"><a href="the-gaussian-copula-model..html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb190-5"><a href="the-gaussian-copula-model..html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(both.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-107"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-107-1.png" alt="Both firms default at year 5." width="672"  />
<p class="caption">
Figure 3.13: Both firms default at year 5.
</p>
</div>
<p>The values within the plot represent the number of cases. Here, we have 343 times (out of 10,000) in which both firms default at the same time in 5 years. Note that this is a cumulative probability of default.</p>
<p>Now, the case in which at least one firm defaults in 5 years.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="the-gaussian-copula-model..html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb191-2"><a href="the-gaussian-copula-model..html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;atleast1&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb191-3"><a href="the-gaussian-copula-model..html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb191-4"><a href="the-gaussian-copula-model..html#cb191-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb191-5"><a href="the-gaussian-copula-model..html#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(atleast1.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-108"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-108-1.png" alt="At least one firm defaults in 5 years." width="672"  />
<p class="caption">
Figure 3.14: At least one firm defaults in 5 years.
</p>
</div>
<p>Only firm 1 defaults in 5 years.</p>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="the-gaussian-copula-model..html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb192-2"><a href="the-gaussian-copula-model..html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb192-3"><a href="the-gaussian-copula-model..html#cb192-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb192-4"><a href="the-gaussian-copula-model..html#cb192-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb192-5"><a href="the-gaussian-copula-model..html#cb192-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm1.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-109"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-109-1.png" alt="Only firm 1 defaults in 5 years." width="672"  />
<p class="caption">
Figure 3.15: Only firm 1 defaults in 5 years.
</p>
</div>
<p>Only firm 2 defaults in 5 years.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="the-gaussian-copula-model..html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb193-2"><a href="the-gaussian-copula-model..html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim=</span>L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb193-3"><a href="the-gaussian-copula-model..html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb193-4"><a href="the-gaussian-copula-model..html#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb193-5"><a href="the-gaussian-copula-model..html#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm2.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-110-1.png" alt="Only firm 2 defaults in 5 years." width="672"  />
<p class="caption">
Figure 3.16: Only firm 2 defaults in 5 years.
</p>
</div>
<p>This is the case in which only one firm defaults.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="the-gaussian-copula-model..html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb194-2"><a href="the-gaussian-copula-model..html#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyone&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb194-3"><a href="the-gaussian-copula-model..html#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb194-4"><a href="the-gaussian-copula-model..html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb194-5"><a href="the-gaussian-copula-model..html#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyone.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-111"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-111-1.png" alt="Only one firm defaults in 5 years." width="672"  />
<p class="caption">
Figure 3.17: Only one firm defaults in 5 years.
</p>
</div>
<p>This is the case in which no one firm defaults.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="the-gaussian-copula-model..html#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb195-2"><a href="the-gaussian-copula-model..html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb195-3"><a href="the-gaussian-copula-model..html#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb195-4"><a href="the-gaussian-copula-model..html#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span><span class="dv">2</span>)</span>
<span id="cb195-5"><a href="the-gaussian-copula-model..html#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(none.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-112"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-112-1.png" alt="No firm defaults in 5 years." width="672"  />
<p class="caption">
Figure 3.18: No firm defaults in 5 years.
</p>
</div>
<p>It is a good idea to summarize all previous plots in one.</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="the-gaussian-copula-model..html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># none</span></span>
<span id="cb196-2"><a href="the-gaussian-copula-model..html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb196-3"><a href="the-gaussian-copula-model..html#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-4"><a href="the-gaussian-copula-model..html#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-5"><a href="the-gaussian-copula-model..html#cb196-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;None.&quot;</span>) </span>
<span id="cb196-6"><a href="the-gaussian-copula-model..html#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-7"><a href="the-gaussian-copula-model..html#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-8"><a href="the-gaussian-copula-model..html#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(none.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb196-9"><a href="the-gaussian-copula-model..html#cb196-9" aria-hidden="true" tabindex="-1"></a><span class="co"># both</span></span>
<span id="cb196-10"><a href="the-gaussian-copula-model..html#cb196-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-11"><a href="the-gaussian-copula-model..html#cb196-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-12"><a href="the-gaussian-copula-model..html#cb196-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Both.&quot;</span>) </span>
<span id="cb196-13"><a href="the-gaussian-copula-model..html#cb196-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-14"><a href="the-gaussian-copula-model..html#cb196-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-15"><a href="the-gaussian-copula-model..html#cb196-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(both.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb196-16"><a href="the-gaussian-copula-model..html#cb196-16" aria-hidden="true" tabindex="-1"></a><span class="co"># atleast1</span></span>
<span id="cb196-17"><a href="the-gaussian-copula-model..html#cb196-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-18"><a href="the-gaussian-copula-model..html#cb196-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;atleast1&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-19"><a href="the-gaussian-copula-model..html#cb196-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;At least one.&quot;</span>)</span>
<span id="cb196-20"><a href="the-gaussian-copula-model..html#cb196-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-21"><a href="the-gaussian-copula-model..html#cb196-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-22"><a href="the-gaussian-copula-model..html#cb196-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(atleast1.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb196-23"><a href="the-gaussian-copula-model..html#cb196-23" aria-hidden="true" tabindex="-1"></a><span class="co"># onlyfirm1</span></span>
<span id="cb196-24"><a href="the-gaussian-copula-model..html#cb196-24" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-25"><a href="the-gaussian-copula-model..html#cb196-25" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-26"><a href="the-gaussian-copula-model..html#cb196-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Only Firm1.&quot;</span>)</span>
<span id="cb196-27"><a href="the-gaussian-copula-model..html#cb196-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-28"><a href="the-gaussian-copula-model..html#cb196-28" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-29"><a href="the-gaussian-copula-model..html#cb196-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm1.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb196-30"><a href="the-gaussian-copula-model..html#cb196-30" aria-hidden="true" tabindex="-1"></a><span class="co"># onlyfirm2</span></span>
<span id="cb196-31"><a href="the-gaussian-copula-model..html#cb196-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-32"><a href="the-gaussian-copula-model..html#cb196-32" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-33"><a href="the-gaussian-copula-model..html#cb196-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Only Firm2.&quot;</span>)</span>
<span id="cb196-34"><a href="the-gaussian-copula-model..html#cb196-34" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-35"><a href="the-gaussian-copula-model..html#cb196-35" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-36"><a href="the-gaussian-copula-model..html#cb196-36" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm2.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb196-37"><a href="the-gaussian-copula-model..html#cb196-37" aria-hidden="true" tabindex="-1"></a><span class="co"># onlyone</span></span>
<span id="cb196-38"><a href="the-gaussian-copula-model..html#cb196-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb196-39"><a href="the-gaussian-copula-model..html#cb196-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;onlyone&quot;</span>, <span class="dv">5</span>]], <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">cex =</span> <span class="fl">0.8</span>, </span>
<span id="cb196-40"><a href="the-gaussian-copula-model..html#cb196-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Only one.&quot;</span>)</span>
<span id="cb196-41"><a href="the-gaussian-copula-model..html#cb196-41" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-42"><a href="the-gaussian-copula-model..html#cb196-42" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb196-43"><a href="the-gaussian-copula-model..html#cb196-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyone.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-113"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-113-1.png" alt="Which firm defaults at year 5?" width="672"  />
<p class="caption">
Figure 3.19: Which firm defaults at year 5?
</p>
</div>
<p>It is interesting to compare two different correlation values. Here, we compare 0 versus 0.2.</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="the-gaussian-copula-model..html#cb197-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># number of firms</span></span>
<span id="cb197-2"><a href="the-gaussian-copula-model..html#cb197-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of simulations</span></span>
<span id="cb197-3"><a href="the-gaussian-copula-model..html#cb197-3" aria-hidden="true" tabindex="-1"></a>rho_pos02 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># correlation</span></span>
<span id="cb197-4"><a href="the-gaussian-copula-model..html#cb197-4" aria-hidden="true" tabindex="-1"></a>corr_pos02 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(rho_pos02, m <span class="sc">*</span> m), m, m) <span class="co"># correlation matrix</span></span>
<span id="cb197-5"><a href="the-gaussian-copula-model..html#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_pos02) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb197-6"><a href="the-gaussian-copula-model..html#cb197-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb197-7"><a href="the-gaussian-copula-model..html#cb197-7" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> corr_pos02)</span>
<span id="cb197-8"><a href="the-gaussian-copula-model..html#cb197-8" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X0)</span>
<span id="cb197-9"><a href="the-gaussian-copula-model..html#cb197-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X0) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Firm1&quot;</span>, <span class="st">&quot;Firm2&quot;</span>)</span></code></pre></div>
<p>Just as before, we create a function, evaluate it, and store results in .</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="the-gaussian-copula-model..html#cb198-1" aria-hidden="true" tabindex="-1"></a>fun.X0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb198-2"><a href="the-gaussian-copula-model..html#cb198-2" aria-hidden="true" tabindex="-1"></a>  both <span class="ot">&lt;-</span> X0[X0<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb198-3"><a href="the-gaussian-copula-model..html#cb198-3" aria-hidden="true" tabindex="-1"></a>  atleast1 <span class="ot">&lt;-</span> X0[X0<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">|</span> X0<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb198-4"><a href="the-gaussian-copula-model..html#cb198-4" aria-hidden="true" tabindex="-1"></a>  onlyfirm1 <span class="ot">&lt;-</span> X0[X0<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb198-5"><a href="the-gaussian-copula-model..html#cb198-5" aria-hidden="true" tabindex="-1"></a>  onlyfirm2 <span class="ot">&lt;-</span> X0[X0<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x, ]</span>
<span id="cb198-6"><a href="the-gaussian-copula-model..html#cb198-6" aria-hidden="true" tabindex="-1"></a>  onlyone <span class="ot">&lt;-</span> X0[(X0<span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">|</span> </span>
<span id="cb198-7"><a href="the-gaussian-copula-model..html#cb198-7" aria-hidden="true" tabindex="-1"></a>                   X0<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x),]</span>
<span id="cb198-8"><a href="the-gaussian-copula-model..html#cb198-8" aria-hidden="true" tabindex="-1"></a>  none <span class="ot">&lt;-</span> X0[X0<span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X0<span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x, ]</span>
<span id="cb198-9"><a href="the-gaussian-copula-model..html#cb198-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb198-10"><a href="the-gaussian-copula-model..html#cb198-10" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">both =</span> both, <span class="at">atleast1 =</span> atleast1, <span class="at">onlyfirm1 =</span> onlyfirm1,</span>
<span id="cb198-11"><a href="the-gaussian-copula-model..html#cb198-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm2 =</span> onlyfirm2, <span class="at">onlyone =</span> onlyone, <span class="at">none =</span> none,</span>
<span id="cb198-12"><a href="the-gaussian-copula-model..html#cb198-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">both.pd =</span> (<span class="fu">nrow</span>(both) <span class="sc">/</span> n), <span class="at">atleast1.pd =</span> (<span class="fu">nrow</span>(atleast1) <span class="sc">/</span> n),</span>
<span id="cb198-13"><a href="the-gaussian-copula-model..html#cb198-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm1.pd =</span> (<span class="fu">nrow</span>(onlyfirm1) <span class="sc">/</span> n), <span class="at">onlyfirm2.pd =</span> (<span class="fu">nrow</span>(onlyfirm2) <span class="sc">/</span>n),</span>
<span id="cb198-14"><a href="the-gaussian-copula-model..html#cb198-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyone.pd =</span> (<span class="fu">nrow</span>(onlyone) <span class="sc">/</span> n), <span class="at">none.pd =</span> (<span class="fu">nrow</span>(none) <span class="sc">/</span> n)) }</span>
<span id="cb198-15"><a href="the-gaussian-copula-model..html#cb198-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-16"><a href="the-gaussian-copula-model..html#cb198-16" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fun.X0, x.y)</span>
<span id="cb198-17"><a href="the-gaussian-copula-model..html#cb198-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-18"><a href="the-gaussian-copula-model..html#cb198-18" aria-hidden="true" tabindex="-1"></a>none.pd0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X0[<span class="st">&quot;none.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb198-19"><a href="the-gaussian-copula-model..html#cb198-19" aria-hidden="true" tabindex="-1"></a>both.pd0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X0[<span class="st">&quot;both.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb198-20"><a href="the-gaussian-copula-model..html#cb198-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb198-21"><a href="the-gaussian-copula-model..html#cb198-21" aria-hidden="true" tabindex="-1"></a>onlyfirm1.pd0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X0[<span class="st">&quot;onlyfirm1.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb198-22"><a href="the-gaussian-copula-model..html#cb198-22" aria-hidden="true" tabindex="-1"></a>onlyfirm2.pd0 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X0[<span class="st">&quot;onlyfirm2.pd&quot;</span>,]) <span class="sc">*</span> n</span></code></pre></div>
<p>A graphical analysis shows that in the case of 0.2 it is more likely that both firms default at the same time, and it is less likely that any firm default at the same time.</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="the-gaussian-copula-model..html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="at">oma =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>))</span>
<span id="cb199-2"><a href="the-gaussian-copula-model..html#cb199-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb199-3"><a href="the-gaussian-copula-model..html#cb199-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, </span>
<span id="cb199-4"><a href="the-gaussian-copula-model..html#cb199-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">main =</span> <span class="st">&quot;Correlation=0.2&quot;</span>) </span>
<span id="cb199-5"><a href="the-gaussian-copula-model..html#cb199-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb199-6"><a href="the-gaussian-copula-model..html#cb199-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb199-7"><a href="the-gaussian-copula-model..html#cb199-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb199-8"><a href="the-gaussian-copula-model..html#cb199-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb199-9"><a href="the-gaussian-copula-model..html#cb199-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb199-10"><a href="the-gaussian-copula-model..html#cb199-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(both.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-11"><a href="the-gaussian-copula-model..html#cb199-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(none.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-12"><a href="the-gaussian-copula-model..html#cb199-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm1.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-13"><a href="the-gaussian-copula-model..html#cb199-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm2.pd[<span class="dv">5</span>]<span class="sc">*</span>n)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-14"><a href="the-gaussian-copula-model..html#cb199-14" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb199-15"><a href="the-gaussian-copula-model..html#cb199-15" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X0[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> L,</span>
<span id="cb199-16"><a href="the-gaussian-copula-model..html#cb199-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">main =</span> <span class="st">&quot;Correlation=0.&quot;</span>) </span>
<span id="cb199-17"><a href="the-gaussian-copula-model..html#cb199-17" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X0[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb199-18"><a href="the-gaussian-copula-model..html#cb199-18" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X0[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb199-19"><a href="the-gaussian-copula-model..html#cb199-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X0[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb199-20"><a href="the-gaussian-copula-model..html#cb199-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb199-21"><a href="the-gaussian-copula-model..html#cb199-21" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb199-22"><a href="the-gaussian-copula-model..html#cb199-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(both.pd0[<span class="dv">5</span>])), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-23"><a href="the-gaussian-copula-model..html#cb199-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(none.pd0[<span class="dv">5</span>])), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-24"><a href="the-gaussian-copula-model..html#cb199-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm1.pd0[<span class="dv">5</span>])), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb199-25"><a href="the-gaussian-copula-model..html#cb199-25" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm2.pd0[<span class="dv">5</span>])), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-116"></span>
<img src="SUMMARY_files/figure-html/unnamed-chunk-116-1.png" alt="Cases per quadrant. Dotted lines corresponds to year 5." width="672"  />
<p class="caption">
Figure 3.20: Cases per quadrant. Dotted lines corresponds to year 5.
</p>
</div>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="the-gaussian-copula-model..html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span></code></pre></div>
<p>Very interesting indeed.</p>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="the-gaussian-copula-model..html#cb201-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># number of firms</span></span>
<span id="cb201-2"><a href="the-gaussian-copula-model..html#cb201-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># number of simulations</span></span>
<span id="cb201-3"><a href="the-gaussian-copula-model..html#cb201-3" aria-hidden="true" tabindex="-1"></a>rho_pos00 <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># correlation</span></span>
<span id="cb201-4"><a href="the-gaussian-copula-model..html#cb201-4" aria-hidden="true" tabindex="-1"></a>rho_pos02 <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb201-5"><a href="the-gaussian-copula-model..html#cb201-5" aria-hidden="true" tabindex="-1"></a>corr_pos00 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(rho_pos00, m <span class="sc">*</span> m), m, m) <span class="co"># correlation matrix</span></span>
<span id="cb201-6"><a href="the-gaussian-copula-model..html#cb201-6" aria-hidden="true" tabindex="-1"></a>corr_pos02 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(rho_pos02, m <span class="sc">*</span> m), m, m) <span class="co"># correlation matrix</span></span>
<span id="cb201-7"><a href="the-gaussian-copula-model..html#cb201-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_pos00) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb201-8"><a href="the-gaussian-copula-model..html#cb201-8" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(corr_pos02) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb201-9"><a href="the-gaussian-copula-model..html#cb201-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb201-10"><a href="the-gaussian-copula-model..html#cb201-10" aria-hidden="true" tabindex="-1"></a>X00 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> corr_pos00)</span>
<span id="cb201-11"><a href="the-gaussian-copula-model..html#cb201-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb201-12"><a href="the-gaussian-copula-model..html#cb201-12" aria-hidden="true" tabindex="-1"></a>X02 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> corr_pos02)</span>
<span id="cb201-13"><a href="the-gaussian-copula-model..html#cb201-13" aria-hidden="true" tabindex="-1"></a>X00<span class="fl">.02</span> <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rbind</span>(X00, X02))</span>
<span id="cb201-14"><a href="the-gaussian-copula-model..html#cb201-14" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X00<span class="fl">.02</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Firm1&quot;</span>, <span class="st">&quot;Firm2&quot;</span>)</span>
<span id="cb201-15"><a href="the-gaussian-copula-model..html#cb201-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-16"><a href="the-gaussian-copula-model..html#cb201-16" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">20000</span></span>
<span id="cb201-17"><a href="the-gaussian-copula-model..html#cb201-17" aria-hidden="true" tabindex="-1"></a>fun.X0 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb201-18"><a href="the-gaussian-copula-model..html#cb201-18" aria-hidden="true" tabindex="-1"></a>  both <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb201-19"><a href="the-gaussian-copula-model..html#cb201-19" aria-hidden="true" tabindex="-1"></a>  atleast1 <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">|</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb201-20"><a href="the-gaussian-copula-model..html#cb201-20" aria-hidden="true" tabindex="-1"></a>  onlyfirm1 <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x, ]</span>
<span id="cb201-21"><a href="the-gaussian-copula-model..html#cb201-21" aria-hidden="true" tabindex="-1"></a>  onlyfirm2 <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x, ]</span>
<span id="cb201-22"><a href="the-gaussian-copula-model..html#cb201-22" aria-hidden="true" tabindex="-1"></a>  onlyone <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[(X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&lt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x <span class="sc">|</span> </span>
<span id="cb201-23"><a href="the-gaussian-copula-model..html#cb201-23" aria-hidden="true" tabindex="-1"></a>                   X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&lt;</span> x),]</span>
<span id="cb201-24"><a href="the-gaussian-copula-model..html#cb201-24" aria-hidden="true" tabindex="-1"></a>  none <span class="ot">&lt;-</span> X00<span class="fl">.02</span>[X00<span class="fl">.02</span><span class="sc">$</span>Firm2 <span class="sc">&gt;</span> x <span class="sc">&amp;</span> X00<span class="fl">.02</span><span class="sc">$</span>Firm1 <span class="sc">&gt;</span> x, ]</span>
<span id="cb201-25"><a href="the-gaussian-copula-model..html#cb201-25" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb201-26"><a href="the-gaussian-copula-model..html#cb201-26" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">both =</span> both, <span class="at">atleast1 =</span> atleast1, <span class="at">onlyfirm1 =</span> onlyfirm1,</span>
<span id="cb201-27"><a href="the-gaussian-copula-model..html#cb201-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm2 =</span> onlyfirm2, <span class="at">onlyone =</span> onlyone, <span class="at">none =</span> none,</span>
<span id="cb201-28"><a href="the-gaussian-copula-model..html#cb201-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">both.pd =</span> (<span class="fu">nrow</span>(both) <span class="sc">/</span> n), <span class="at">atleast1.pd =</span> (<span class="fu">nrow</span>(atleast1) <span class="sc">/</span> n),</span>
<span id="cb201-29"><a href="the-gaussian-copula-model..html#cb201-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyfirm1.pd =</span> (<span class="fu">nrow</span>(onlyfirm1) <span class="sc">/</span> n), <span class="at">onlyfirm2.pd =</span> (<span class="fu">nrow</span>(onlyfirm2) <span class="sc">/</span>n),</span>
<span id="cb201-30"><a href="the-gaussian-copula-model..html#cb201-30" aria-hidden="true" tabindex="-1"></a>  <span class="at">onlyone.pd =</span> (<span class="fu">nrow</span>(onlyone) <span class="sc">/</span> n), <span class="at">none.pd =</span> (<span class="fu">nrow</span>(none) <span class="sc">/</span> n)) }</span>
<span id="cb201-31"><a href="the-gaussian-copula-model..html#cb201-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-32"><a href="the-gaussian-copula-model..html#cb201-32" aria-hidden="true" tabindex="-1"></a>X00<span class="fl">.02</span> <span class="ot">&lt;-</span> <span class="fu">mapply</span>(fun.X0, x.y)</span>
<span id="cb201-33"><a href="the-gaussian-copula-model..html#cb201-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-34"><a href="the-gaussian-copula-model..html#cb201-34" aria-hidden="true" tabindex="-1"></a>none.pd0002 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X00<span class="fl">.02</span>[<span class="st">&quot;none.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb201-35"><a href="the-gaussian-copula-model..html#cb201-35" aria-hidden="true" tabindex="-1"></a>both.pd0002 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X00<span class="fl">.02</span>[<span class="st">&quot;both.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb201-36"><a href="the-gaussian-copula-model..html#cb201-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb201-37"><a href="the-gaussian-copula-model..html#cb201-37" aria-hidden="true" tabindex="-1"></a>onlyfirm1.pd0002 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X00<span class="fl">.02</span>[<span class="st">&quot;onlyfirm1.pd&quot;</span>,]) <span class="sc">*</span> n</span>
<span id="cb201-38"><a href="the-gaussian-copula-model..html#cb201-38" aria-hidden="true" tabindex="-1"></a>onlyfirm2.pd0002 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X00<span class="fl">.02</span>[<span class="st">&quot;onlyfirm2.pd&quot;</span>,]) <span class="sc">*</span> n</span></code></pre></div>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="the-gaussian-copula-model..html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb202-2"><a href="the-gaussian-copula-model..html#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, </span>
<span id="cb202-3"><a href="the-gaussian-copula-model..html#cb202-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">main =</span> <span class="st">&quot;Correlation=0.2&quot;</span>) </span>
<span id="cb202-4"><a href="the-gaussian-copula-model..html#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb202-5"><a href="the-gaussian-copula-model..html#cb202-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb202-6"><a href="the-gaussian-copula-model..html#cb202-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb202-7"><a href="the-gaussian-copula-model..html#cb202-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb202-8"><a href="the-gaussian-copula-model..html#cb202-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb202-9"><a href="the-gaussian-copula-model..html#cb202-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(both.pd0002[<span class="dv">5</span>]<span class="sc">/</span>n<span class="sc">*</span><span class="dv">100</span>)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb202-10"><a href="the-gaussian-copula-model..html#cb202-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(none.pd0002[<span class="dv">5</span>]<span class="sc">/</span>n<span class="sc">*</span><span class="dv">100</span>)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb202-11"><a href="the-gaussian-copula-model..html#cb202-11" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm1.pd0002[<span class="dv">5</span>]<span class="sc">/</span>n<span class="sc">*</span><span class="dv">100</span>)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span>
<span id="cb202-12"><a href="the-gaussian-copula-model..html#cb202-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste</span>(onlyfirm2.pd0002[<span class="dv">5</span>]<span class="sc">/</span>n<span class="sc">*</span><span class="dv">100</span>)), <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>)</span></code></pre></div>
<p><img src="SUMMARY_files/figure-html/unnamed-chunk-118-1.png" width="672"  /></p>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="the-gaussian-copula-model..html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb203-2"><a href="the-gaussian-copula-model..html#cb203-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, </span>
<span id="cb203-3"><a href="the-gaussian-copula-model..html#cb203-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">main =</span> <span class="st">&quot;Correlation=0.2&quot;</span>) </span>
<span id="cb203-4"><a href="the-gaussian-copula-model..html#cb203-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb203-5"><a href="the-gaussian-copula-model..html#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb203-6"><a href="the-gaussian-copula-model..html#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb203-7"><a href="the-gaussian-copula-model..html#cb203-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb203-8"><a href="the-gaussian-copula-model..html#cb203-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb203-9"><a href="the-gaussian-copula-model..html#cb203-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb203-10"><a href="the-gaussian-copula-model..html#cb203-10" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb203-11"><a href="the-gaussian-copula-model..html#cb203-11" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb203-12"><a href="the-gaussian-copula-model..html#cb203-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">4</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb203-13"><a href="the-gaussian-copula-model..html#cb203-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">4</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="SUMMARY_files/figure-html/unnamed-chunk-119-1.png" width="672"  /></p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="the-gaussian-copula-model..html#cb204-1" aria-hidden="true" tabindex="-1"></a>x.y[<span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] -1.036433</code></pre>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="the-gaussian-copula-model..html#cb206-1" aria-hidden="true" tabindex="-1"></a>x.y[<span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] -1.281552</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="the-gaussian-copula-model..html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">pty =</span> <span class="st">&quot;s&quot;</span>)</span>
<span id="cb208-2"><a href="the-gaussian-copula-model..html#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;none&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">xlim =</span> L, <span class="at">ylim =</span> L, </span>
<span id="cb208-3"><a href="the-gaussian-copula-model..html#cb208-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">0.8</span>, <span class="at">main =</span> <span class="st">&quot;Correlation=0.2&quot;</span>) </span>
<span id="cb208-4"><a href="the-gaussian-copula-model..html#cb208-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb208-5"><a href="the-gaussian-copula-model..html#cb208-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb208-6"><a href="the-gaussian-copula-model..html#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb208-7"><a href="the-gaussian-copula-model..html#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb208-8"><a href="the-gaussian-copula-model..html#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm1&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb208-9"><a href="the-gaussian-copula-model..html#cb208-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;onlyfirm2&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb208-10"><a href="the-gaussian-copula-model..html#cb208-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">5</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb208-11"><a href="the-gaussian-copula-model..html#cb208-11" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(X00<span class="fl">.02</span>[[<span class="st">&quot;both&quot;</span>, <span class="dv">4</span>]], <span class="at">pch =</span> <span class="st">&quot;.&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)</span>
<span id="cb208-12"><a href="the-gaussian-copula-model..html#cb208-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb208-13"><a href="the-gaussian-copula-model..html#cb208-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">5</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb208-14"><a href="the-gaussian-copula-model..html#cb208-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> x.y[<span class="dv">4</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb208-15"><a href="the-gaussian-copula-model..html#cb208-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> x.y[<span class="dv">4</span>], <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="SUMMARY_files/figure-html/unnamed-chunk-120-1.png" width="672"  /></p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="the-gaussian-copula-model..html#cb209-1" aria-hidden="true" tabindex="-1"></a>x.y[<span class="dv">5</span>]</span></code></pre></div>
<pre><code>## [1] -1.036433</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="the-gaussian-copula-model..html#cb211-1" aria-hidden="true" tabindex="-1"></a>x.y[<span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] -1.281552</code></pre>
</div>
<div id="ten-firms." class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Ten firms.<a href="the-gaussian-copula-model..html#ten-firms." class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The original Hullâ€™s example proposes a 10 firm case and here we implement this example following a simulation approach. First, we need a <span class="math inline">\(10\times10\)</span> correlation matrix to produce the new <span class="math inline">\(x\)</span> values using a random multi-variate distribution algorithm. According to Hullâ€™s example the copula default correlations between each pair of companies is 0.2. The code below has the option to vary the default correlation given a uniform random distribution.</p>
<p>The new <span class="math inline">\(10\times10\)</span> correlation matrix is then:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="the-gaussian-copula-model..html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the correlation matrix.</span></span>
<span id="cb213-2"><a href="the-gaussian-copula-model..html#cb213-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of firms.</span></span>
<span id="cb213-3"><a href="the-gaussian-copula-model..html#cb213-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000000</span> <span class="co"># number of simulations per firm.</span></span>
<span id="cb213-4"><a href="the-gaussian-copula-model..html#cb213-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fl">0.2</span>, m <span class="sc">*</span> m), m, m) </span>
<span id="cb213-5"><a href="the-gaussian-copula-model..html#cb213-5" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">lower.tri</span>(x) </span>
<span id="cb213-6"><a href="the-gaussian-copula-model..html#cb213-6" aria-hidden="true" tabindex="-1"></a>x[ind] <span class="ot">&lt;-</span> <span class="fu">t</span>(x)[ind] </span>
<span id="cb213-7"><a href="the-gaussian-copula-model..html#cb213-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(x) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb213-8"><a href="the-gaussian-copula-model..html#cb213-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(x, <span class="at">caption =</span> <span class="st">&quot;Correlation matrix 0.2.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-121">Table 3.13: </span>Correlation matrix 0.2.</caption>
<tbody>
<tr class="odd">
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
</tr>
<tr class="odd">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
<td align="right">0.2</td>
</tr>
<tr class="even">
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">0.2</td>
<td align="right">1.0</td>
</tr>
</tbody>
</table>
<p>Now, we can simulate the multivariate normal distribution. The variable length is 1,000,000 for each firm. This is big, but we can visualize the header of this variable. We choose a higher number of simulations because now we need 10 firms to meet a single constraint.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="the-gaussian-copula-model..html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the simulated cases.</span></span>
<span id="cb214-2"><a href="the-gaussian-copula-model..html#cb214-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>) <span class="co"># Reproducibility.</span></span>
<span id="cb214-3"><a href="the-gaussian-copula-model..html#cb214-3" aria-hidden="true" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> x)</span>
<span id="cb214-4"><a href="the-gaussian-copula-model..html#cb214-4" aria-hidden="true" tabindex="-1"></a>X10 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X10) <span class="co"># 10,000,000 observations.</span></span>
<span id="cb214-5"><a href="the-gaussian-copula-model..html#cb214-5" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(X10), <span class="at">caption =</span> <span class="st">&quot;10 firms&#39; performance, 1,000,000 simulations.&quot;</span>,</span>
<span id="cb214-6"><a href="the-gaussian-copula-model..html#cb214-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-122">Table 3.14: </span>10 firmsâ€™ performance, 1,000,000 simulations.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1.541</td>
<td align="right">0.747</td>
<td align="right">2.270</td>
<td align="right">0.546</td>
<td align="right">1.500</td>
<td align="right">0.106</td>
<td align="right">1.587</td>
<td align="right">1.269</td>
<td align="right">0.453</td>
<td align="right">-0.527</td>
</tr>
<tr class="even">
<td align="right">1.867</td>
<td align="right">-0.840</td>
<td align="right">0.272</td>
<td align="right">-0.935</td>
<td align="right">-0.323</td>
<td align="right">0.688</td>
<td align="right">-0.411</td>
<td align="right">-0.642</td>
<td align="right">2.869</td>
<td align="right">1.432</td>
</tr>
<tr class="odd">
<td align="right">-1.924</td>
<td align="right">-0.058</td>
<td align="right">1.678</td>
<td align="right">1.840</td>
<td align="right">-0.964</td>
<td align="right">0.211</td>
<td align="right">-0.277</td>
<td align="right">0.704</td>
<td align="right">0.197</td>
<td align="right">0.482</td>
</tr>
<tr class="even">
<td align="right">-0.451</td>
<td align="right">-0.997</td>
<td align="right">-1.471</td>
<td align="right">-0.565</td>
<td align="right">0.227</td>
<td align="right">0.429</td>
<td align="right">-1.809</td>
<td align="right">-0.783</td>
<td align="right">-0.659</td>
<td align="right">0.983</td>
</tr>
<tr class="odd">
<td align="right">-1.105</td>
<td align="right">0.219</td>
<td align="right">0.191</td>
<td align="right">1.552</td>
<td align="right">-1.037</td>
<td align="right">0.480</td>
<td align="right">1.277</td>
<td align="right">-1.878</td>
<td align="right">-1.581</td>
<td align="right">-0.066</td>
</tr>
<tr class="even">
<td align="right">-0.968</td>
<td align="right">-0.284</td>
<td align="right">0.309</td>
<td align="right">-1.529</td>
<td align="right">0.012</td>
<td align="right">-1.413</td>
<td align="right">-0.188</td>
<td align="right">-0.939</td>
<td align="right">-0.496</td>
<td align="right">-0.174</td>
</tr>
</tbody>
</table>
<p>How do we extract those cases in which all 10 firms will default in 5 years (at the same time)? Here are the first 6 of those cases. Note that in all cases the values are lower than <span class="math inline">\(-1.036433\)</span>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="the-gaussian-copula-model..html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Given that we have 10 firms, it is easier to use filter_all function.</span></span>
<span id="cb215-2"><a href="the-gaussian-copula-model..html#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Although probably this could be simplified even further.</span></span>
<span id="cb215-3"><a href="the-gaussian-copula-model..html#cb215-3" aria-hidden="true" tabindex="-1"></a>y5.all<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]))</span>
<span id="cb215-4"><a href="the-gaussian-copula-model..html#cb215-4" aria-hidden="true" tabindex="-1"></a>y4.all<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">4</span>])) </span>
<span id="cb215-5"><a href="the-gaussian-copula-model..html#cb215-5" aria-hidden="true" tabindex="-1"></a>y3.all<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">3</span>])) </span>
<span id="cb215-6"><a href="the-gaussian-copula-model..html#cb215-6" aria-hidden="true" tabindex="-1"></a>y2.all<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">2</span>])) </span>
<span id="cb215-7"><a href="the-gaussian-copula-model..html#cb215-7" aria-hidden="true" tabindex="-1"></a>y1.all<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">1</span>])) </span></code></pre></div>
<p>Letâ€™s analyze the case of 5 years.</p>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="the-gaussian-copula-model..html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(y5.all<span class="fl">.2</span>), </span>
<span id="cb216-2"><a href="the-gaussian-copula-model..html#cb216-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Cases in which all 10 firms default in five years.&quot;</span>, </span>
<span id="cb216-3"><a href="the-gaussian-copula-model..html#cb216-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-124">Table 3.15: </span>Cases in which all 10 firms default in five years.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.793</td>
<td align="right">-3.143</td>
<td align="right">-1.945</td>
<td align="right">-1.054</td>
<td align="right">-3.511</td>
<td align="right">-1.746</td>
<td align="right">-1.789</td>
<td align="right">-2.098</td>
<td align="right">-1.998</td>
<td align="right">-2.809</td>
</tr>
<tr class="even">
<td align="right">-1.423</td>
<td align="right">-1.779</td>
<td align="right">-1.209</td>
<td align="right">-1.486</td>
<td align="right">-1.304</td>
<td align="right">-1.630</td>
<td align="right">-1.455</td>
<td align="right">-2.358</td>
<td align="right">-1.238</td>
<td align="right">-1.070</td>
</tr>
<tr class="odd">
<td align="right">-2.272</td>
<td align="right">-1.640</td>
<td align="right">-2.152</td>
<td align="right">-2.374</td>
<td align="right">-1.943</td>
<td align="right">-3.206</td>
<td align="right">-1.372</td>
<td align="right">-1.582</td>
<td align="right">-2.682</td>
<td align="right">-3.230</td>
</tr>
<tr class="even">
<td align="right">-3.229</td>
<td align="right">-1.487</td>
<td align="right">-1.443</td>
<td align="right">-2.503</td>
<td align="right">-1.582</td>
<td align="right">-1.050</td>
<td align="right">-1.202</td>
<td align="right">-1.525</td>
<td align="right">-1.608</td>
<td align="right">-3.308</td>
</tr>
<tr class="odd">
<td align="right">-1.172</td>
<td align="right">-1.079</td>
<td align="right">-1.508</td>
<td align="right">-1.605</td>
<td align="right">-2.093</td>
<td align="right">-1.407</td>
<td align="right">-1.972</td>
<td align="right">-3.347</td>
<td align="right">-1.878</td>
<td align="right">-1.624</td>
</tr>
<tr class="even">
<td align="right">-2.925</td>
<td align="right">-2.470</td>
<td align="right">-1.483</td>
<td align="right">-1.612</td>
<td align="right">-1.452</td>
<td align="right">-1.404</td>
<td align="right">-2.710</td>
<td align="right">-2.011</td>
<td align="right">-1.296</td>
<td align="right">-2.440</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="the-gaussian-copula-model..html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(y5.all<span class="fl">.2</span>) <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]), <span class="at">caption =</span> <span class="st">&quot;Check if all of them default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-125">Table 3.16: </span>Check if all of them default.</caption>
<thead>
<tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
<th align="left">X8</th>
<th align="left">X9</th>
<th align="left">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>How many cases are there?</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="the-gaussian-copula-model..html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(y5.all<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 72</code></pre>
<p>Which are those 72 cases?</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="the-gaussian-copula-model..html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, I compare only firm 1 as if firm 1 defaults, then the rest default.</span></span>
<span id="cb220-2"><a href="the-gaussian-copula-model..html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">matrix</span>(<span class="fu">which</span>(X10[,<span class="dv">1</span>] <span class="sc">%in%</span> y5.all<span class="fl">.2</span>[,<span class="dv">1</span>]), <span class="dv">6</span>, <span class="dv">9</span>), </span>
<span id="cb220-3"><a href="the-gaussian-copula-model..html#cb220-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Which of the 1,000,000 cases represent a default of all </span></span>
<span id="cb220-4"><a href="the-gaussian-copula-model..html#cb220-4" aria-hidden="true" tabindex="-1"></a><span class="st">      firms in five years?&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-127">Table 3.17: </span>Which of the 1,000,000 cases represent a default of all
firms in five years?</caption>
<tbody>
<tr class="odd">
<td align="right">16257</td>
<td align="right">99432</td>
<td align="right">171012</td>
<td align="right">319557</td>
<td align="right">413425</td>
<td align="right">511731</td>
<td align="right">643935</td>
<td align="right">715625</td>
<td align="right">796118</td>
</tr>
<tr class="even">
<td align="right">32298</td>
<td align="right">101750</td>
<td align="right">266761</td>
<td align="right">353059</td>
<td align="right">423852</td>
<td align="right">527750</td>
<td align="right">644895</td>
<td align="right">727562</td>
<td align="right">797265</td>
</tr>
<tr class="odd">
<td align="right">57098</td>
<td align="right">104810</td>
<td align="right">297762</td>
<td align="right">391778</td>
<td align="right">437629</td>
<td align="right">574643</td>
<td align="right">647511</td>
<td align="right">736041</td>
<td align="right">808143</td>
</tr>
<tr class="even">
<td align="right">62188</td>
<td align="right">118416</td>
<td align="right">300925</td>
<td align="right">402689</td>
<td align="right">444338</td>
<td align="right">597147</td>
<td align="right">690749</td>
<td align="right">745317</td>
<td align="right">808624</td>
</tr>
<tr class="odd">
<td align="right">74173</td>
<td align="right">125947</td>
<td align="right">311908</td>
<td align="right">405804</td>
<td align="right">492912</td>
<td align="right">618391</td>
<td align="right">700476</td>
<td align="right">747221</td>
<td align="right">813924</td>
</tr>
<tr class="even">
<td align="right">81982</td>
<td align="right">132862</td>
<td align="right">317946</td>
<td align="right">406553</td>
<td align="right">509996</td>
<td align="right">622673</td>
<td align="right">705705</td>
<td align="right">749223</td>
<td align="right">823963</td>
</tr>
</tbody>
</table>
<p>In total, we only have 72 cases. This is, the 10 firms will default at the same time in 5 years in 72 out of 1,000,000 total cases. For the rest of the years, the cases are less frequent, in fact we have zero cases for year 1, 2 and 3.</p>
<p>How do we extract those cases in which at least one of the 10 firms will default?</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="the-gaussian-copula-model..html#cb221-1" aria-hidden="true" tabindex="-1"></a>y5.any<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]))</span>
<span id="cb221-2"><a href="the-gaussian-copula-model..html#cb221-2" aria-hidden="true" tabindex="-1"></a>y4.any<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">4</span>]))</span>
<span id="cb221-3"><a href="the-gaussian-copula-model..html#cb221-3" aria-hidden="true" tabindex="-1"></a>y3.any<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">3</span>]))</span>
<span id="cb221-4"><a href="the-gaussian-copula-model..html#cb221-4" aria-hidden="true" tabindex="-1"></a>y2.any<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">2</span>]))</span>
<span id="cb221-5"><a href="the-gaussian-copula-model..html#cb221-5" aria-hidden="true" tabindex="-1"></a>y1.any<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(X10, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">1</span>]))</span></code></pre></div>
<p>Here are the first 6 cases for the 5-year default.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="the-gaussian-copula-model..html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(y5.any<span class="fl">.2</span>), <span class="at">caption =</span> <span class="st">&quot;At least one firm default in five years.&quot;</span>,</span>
<span id="cb222-2"><a href="the-gaussian-copula-model..html#cb222-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-129">Table 3.18: </span>At least one firm default in five years.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.924</td>
<td align="right">-0.058</td>
<td align="right">1.678</td>
<td align="right">1.840</td>
<td align="right">-0.964</td>
<td align="right">0.211</td>
<td align="right">-0.277</td>
<td align="right">0.704</td>
<td align="right">0.197</td>
<td align="right">0.482</td>
</tr>
<tr class="even">
<td align="right">-0.451</td>
<td align="right">-0.997</td>
<td align="right">-1.471</td>
<td align="right">-0.565</td>
<td align="right">0.227</td>
<td align="right">0.429</td>
<td align="right">-1.809</td>
<td align="right">-0.783</td>
<td align="right">-0.659</td>
<td align="right">0.983</td>
</tr>
<tr class="odd">
<td align="right">-1.105</td>
<td align="right">0.219</td>
<td align="right">0.191</td>
<td align="right">1.552</td>
<td align="right">-1.037</td>
<td align="right">0.480</td>
<td align="right">1.277</td>
<td align="right">-1.878</td>
<td align="right">-1.581</td>
<td align="right">-0.066</td>
</tr>
<tr class="even">
<td align="right">-0.968</td>
<td align="right">-0.284</td>
<td align="right">0.309</td>
<td align="right">-1.529</td>
<td align="right">0.012</td>
<td align="right">-1.413</td>
<td align="right">-0.188</td>
<td align="right">-0.939</td>
<td align="right">-0.496</td>
<td align="right">-0.174</td>
</tr>
<tr class="odd">
<td align="right">-0.836</td>
<td align="right">-0.828</td>
<td align="right">0.982</td>
<td align="right">0.375</td>
<td align="right">-0.341</td>
<td align="right">-1.382</td>
<td align="right">-2.533</td>
<td align="right">-1.268</td>
<td align="right">-1.214</td>
<td align="right">-1.069</td>
</tr>
<tr class="even">
<td align="right">-0.495</td>
<td align="right">-1.382</td>
<td align="right">-0.932</td>
<td align="right">-0.625</td>
<td align="right">1.327</td>
<td align="right">-2.546</td>
<td align="right">0.071</td>
<td align="right">-2.605</td>
<td align="right">-1.116</td>
<td align="right">-1.340</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="the-gaussian-copula-model..html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(y5.any<span class="fl">.2</span>) <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]), <span class="at">caption =</span> <span class="st">&quot;Check which one(s) default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-130">Table 3.19: </span>Check which one(s) default.</caption>
<thead>
<tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
<th align="left">X8</th>
<th align="left">X9</th>
<th align="left">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>How many cases are these?</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="the-gaussian-copula-model..html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(y5.any<span class="fl">.2</span>)</span></code></pre></div>
<pre><code>## [1] 682148</code></pre>
<p>In total, we have 682,148 cases. This is, at least one of 10 firms will default in 5 years in 682,148 of 1,000,000 cases.</p>
<p>And how to convert them into probabilities?</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="the-gaussian-copula-model..html#cb226-1" aria-hidden="true" tabindex="-1"></a>atleastone02 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(<span class="fu">nrow</span>(y1.any<span class="fl">.2</span>), <span class="fu">nrow</span>(y2.any<span class="fl">.2</span>),</span>
<span id="cb226-2"><a href="the-gaussian-copula-model..html#cb226-2" aria-hidden="true" tabindex="-1"></a>                <span class="fu">nrow</span>(y3.any<span class="fl">.2</span>), <span class="fu">nrow</span>(y4.any<span class="fl">.2</span>), <span class="fu">nrow</span>(y5.any<span class="fl">.2</span>)))</span>
<span id="cb226-3"><a href="the-gaussian-copula-model..html#cb226-3" aria-hidden="true" tabindex="-1"></a>all02 <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(<span class="fu">nrow</span>(y1.all<span class="fl">.2</span>), <span class="fu">nrow</span>(y2.all<span class="fl">.2</span>),</span>
<span id="cb226-4"><a href="the-gaussian-copula-model..html#cb226-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">nrow</span>(y3.all<span class="fl">.2</span>), <span class="fu">nrow</span>(y4.all<span class="fl">.2</span>), <span class="fu">nrow</span>(y5.all<span class="fl">.2</span>)))</span>
<span id="cb226-5"><a href="the-gaussian-copula-model..html#cb226-5" aria-hidden="true" tabindex="-1"></a>res02 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(all02 <span class="sc">/</span> n, atleastone02 <span class="sc">/</span> n)</span>
<span id="cb226-6"><a href="the-gaussian-copula-model..html#cb226-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(res02) <span class="ot">&lt;-</span> n.year</span>
<span id="cb226-7"><a href="the-gaussian-copula-model..html#cb226-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(res02) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;All firms&quot;</span>, <span class="st">&quot;At least one&quot;</span>)</span>
<span id="cb226-8"><a href="the-gaussian-copula-model..html#cb226-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res02, <span class="at">caption =</span> <span class="st">&quot;Probabilities of default (10 firms, corr=0.2).&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-132">Table 3.20: </span>Probabilities of default (10 firms, corr=0.2).</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">All firms</th>
<th align="right">At least one</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year 1</td>
<td align="right">0.0e+00</td>
<td align="right">0.087276</td>
</tr>
<tr class="even">
<td align="left">year 2</td>
<td align="right">0.0e+00</td>
<td align="right">0.226406</td>
</tr>
<tr class="odd">
<td align="left">year 3</td>
<td align="right">0.0e+00</td>
<td align="right">0.386348</td>
</tr>
<tr class="even">
<td align="left">year 4</td>
<td align="right">1.2e-05</td>
<td align="right">0.543162</td>
</tr>
<tr class="odd">
<td align="left">year 5</td>
<td align="right">7.2e-05</td>
<td align="right">0.682148</td>
</tr>
</tbody>
</table>
<p>Letâ€™s see the difference when we assume a different correlation matrix. This case, the correlation vary randomly between 0.45 and 0.65.</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="the-gaussian-copula-model..html#cb227-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of firms</span></span>
<span id="cb227-2"><a href="the-gaussian-copula-model..html#cb227-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000000</span> <span class="co"># number of simulations</span></span>
<span id="cb227-3"><a href="the-gaussian-copula-model..html#cb227-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb227-4"><a href="the-gaussian-copula-model..html#cb227-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(m <span class="sc">*</span> m, <span class="fl">0.45</span>, <span class="fl">0.65</span>), m, m) </span>
<span id="cb227-5"><a href="the-gaussian-copula-model..html#cb227-5" aria-hidden="true" tabindex="-1"></a>ind <span class="ot">&lt;-</span> <span class="fu">lower.tri</span>(x) </span>
<span id="cb227-6"><a href="the-gaussian-copula-model..html#cb227-6" aria-hidden="true" tabindex="-1"></a>x[ind] <span class="ot">&lt;-</span> <span class="fu">t</span>(x)[ind] </span>
<span id="cb227-7"><a href="the-gaussian-copula-model..html#cb227-7" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(x) <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb227-8"><a href="the-gaussian-copula-model..html#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(x, <span class="at">caption =</span> <span class="st">&quot;Correlation between 0.45 and 0.65.&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-133">Table 3.21: </span>Correlation between 0.45 and 0.65.</caption>
<tbody>
<tr class="odd">
<td align="right">1.000</td>
<td align="right">0.622</td>
<td align="right">0.597</td>
<td align="right">0.622</td>
<td align="right">0.530</td>
<td align="right">0.517</td>
<td align="right">0.518</td>
<td align="right">0.490</td>
<td align="right">0.455</td>
<td align="right">0.578</td>
</tr>
<tr class="even">
<td align="right">0.622</td>
<td align="right">1.000</td>
<td align="right">0.523</td>
<td align="right">0.594</td>
<td align="right">0.465</td>
<td align="right">0.501</td>
<td align="right">0.558</td>
<td align="right">0.560</td>
<td align="right">0.460</td>
<td align="right">0.513</td>
</tr>
<tr class="odd">
<td align="right">0.597</td>
<td align="right">0.523</td>
<td align="right">1.000</td>
<td align="right">0.556</td>
<td align="right">0.485</td>
<td align="right">0.603</td>
<td align="right">0.534</td>
<td align="right">0.524</td>
<td align="right">0.611</td>
<td align="right">0.547</td>
</tr>
<tr class="even">
<td align="right">0.622</td>
<td align="right">0.594</td>
<td align="right">0.556</td>
<td align="right">1.000</td>
<td align="right">0.564</td>
<td align="right">0.555</td>
<td align="right">0.496</td>
<td align="right">0.500</td>
<td align="right">0.502</td>
<td align="right">0.513</td>
</tr>
<tr class="odd">
<td align="right">0.530</td>
<td align="right">0.465</td>
<td align="right">0.485</td>
<td align="right">0.564</td>
<td align="right">1.000</td>
<td align="right">0.608</td>
<td align="right">0.513</td>
<td align="right">0.559</td>
<td align="right">0.647</td>
<td align="right">0.505</td>
</tr>
<tr class="even">
<td align="right">0.517</td>
<td align="right">0.501</td>
<td align="right">0.603</td>
<td align="right">0.555</td>
<td align="right">0.608</td>
<td align="right">1.000</td>
<td align="right">0.452</td>
<td align="right">0.486</td>
<td align="right">0.644</td>
<td align="right">0.518</td>
</tr>
<tr class="odd">
<td align="right">0.518</td>
<td align="right">0.558</td>
<td align="right">0.534</td>
<td align="right">0.496</td>
<td align="right">0.513</td>
<td align="right">0.452</td>
<td align="right">1.000</td>
<td align="right">0.577</td>
<td align="right">0.635</td>
<td align="right">0.466</td>
</tr>
<tr class="even">
<td align="right">0.490</td>
<td align="right">0.560</td>
<td align="right">0.524</td>
<td align="right">0.500</td>
<td align="right">0.559</td>
<td align="right">0.486</td>
<td align="right">0.577</td>
<td align="right">1.000</td>
<td align="right">0.585</td>
<td align="right">0.524</td>
</tr>
<tr class="odd">
<td align="right">0.455</td>
<td align="right">0.460</td>
<td align="right">0.611</td>
<td align="right">0.502</td>
<td align="right">0.647</td>
<td align="right">0.644</td>
<td align="right">0.635</td>
<td align="right">0.585</td>
<td align="right">1.000</td>
<td align="right">0.474</td>
</tr>
<tr class="even">
<td align="right">0.578</td>
<td align="right">0.513</td>
<td align="right">0.547</td>
<td align="right">0.513</td>
<td align="right">0.505</td>
<td align="right">0.518</td>
<td align="right">0.466</td>
<td align="right">0.524</td>
<td align="right">0.474</td>
<td align="right">1.000</td>
</tr>
</tbody>
</table>
<p>The resulting values of are:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="the-gaussian-copula-model..html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">130575</span>)</span>
<span id="cb228-2"><a href="the-gaussian-copula-model..html#cb228-2" aria-hidden="true" tabindex="-1"></a>Xr <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, <span class="at">mu =</span> <span class="fu">rep</span>(<span class="dv">0</span>, m), <span class="at">Sigma =</span> x)</span>
<span id="cb228-3"><a href="the-gaussian-copula-model..html#cb228-3" aria-hidden="true" tabindex="-1"></a>Xr <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(Xr)</span>
<span id="cb228-4"><a href="the-gaussian-copula-model..html#cb228-4" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Xr), <span class="at">caption =</span> <span class="st">&quot;Firms&#39; performance.&quot;</span>, <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-134">Table 3.22: </span>Firmsâ€™ performance.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-2.107</td>
<td align="right">-1.206</td>
<td align="right">-2.033</td>
<td align="right">-1.730</td>
<td align="right">-0.760</td>
<td align="right">-2.207</td>
<td align="right">-0.933</td>
<td align="right">-1.141</td>
<td align="right">-0.296</td>
<td align="right">-1.308</td>
</tr>
<tr class="even">
<td align="right">-1.346</td>
<td align="right">-2.023</td>
<td align="right">-1.661</td>
<td align="right">0.372</td>
<td align="right">-0.326</td>
<td align="right">0.874</td>
<td align="right">-0.328</td>
<td align="right">-0.315</td>
<td align="right">-0.712</td>
<td align="right">-0.266</td>
</tr>
<tr class="odd">
<td align="right">0.178</td>
<td align="right">-1.366</td>
<td align="right">1.120</td>
<td align="right">-1.732</td>
<td align="right">-0.582</td>
<td align="right">-0.820</td>
<td align="right">-0.058</td>
<td align="right">0.379</td>
<td align="right">-0.151</td>
<td align="right">0.294</td>
</tr>
<tr class="even">
<td align="right">0.641</td>
<td align="right">1.168</td>
<td align="right">1.146</td>
<td align="right">1.028</td>
<td align="right">-0.116</td>
<td align="right">1.488</td>
<td align="right">1.292</td>
<td align="right">0.430</td>
<td align="right">-0.186</td>
<td align="right">0.500</td>
</tr>
<tr class="odd">
<td align="right">1.263</td>
<td align="right">-0.132</td>
<td align="right">1.482</td>
<td align="right">-0.572</td>
<td align="right">0.485</td>
<td align="right">0.649</td>
<td align="right">-0.415</td>
<td align="right">-1.470</td>
<td align="right">0.669</td>
<td align="right">0.797</td>
</tr>
<tr class="even">
<td align="right">0.538</td>
<td align="right">0.810</td>
<td align="right">0.435</td>
<td align="right">0.215</td>
<td align="right">0.797</td>
<td align="right">1.257</td>
<td align="right">1.007</td>
<td align="right">1.166</td>
<td align="right">1.767</td>
<td align="right">0.181</td>
</tr>
</tbody>
</table>
<p>Extract the cases in which all ten firms default at the same time in 5 years and the cases in which either firm default at the same time in 5 years.</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="the-gaussian-copula-model..html#cb229-1" aria-hidden="true" tabindex="-1"></a>Xr <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(Xr)</span>
<span id="cb229-2"><a href="the-gaussian-copula-model..html#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="co"># All firms.</span></span>
<span id="cb229-3"><a href="the-gaussian-copula-model..html#cb229-3" aria-hidden="true" tabindex="-1"></a>Xr.y1.all <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">1</span>])) </span>
<span id="cb229-4"><a href="the-gaussian-copula-model..html#cb229-4" aria-hidden="true" tabindex="-1"></a>Xr.y2.all <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">2</span>])) </span>
<span id="cb229-5"><a href="the-gaussian-copula-model..html#cb229-5" aria-hidden="true" tabindex="-1"></a>Xr.y3.all <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">3</span>])) </span>
<span id="cb229-6"><a href="the-gaussian-copula-model..html#cb229-6" aria-hidden="true" tabindex="-1"></a>Xr.y4.all <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">4</span>]))</span>
<span id="cb229-7"><a href="the-gaussian-copula-model..html#cb229-7" aria-hidden="true" tabindex="-1"></a>Xr.y5.all <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">all_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">5</span>])) </span>
<span id="cb229-8"><a href="the-gaussian-copula-model..html#cb229-8" aria-hidden="true" tabindex="-1"></a><span class="co"># At least one firm.</span></span>
<span id="cb229-9"><a href="the-gaussian-copula-model..html#cb229-9" aria-hidden="true" tabindex="-1"></a>Xr.y1.any <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">1</span>]))</span>
<span id="cb229-10"><a href="the-gaussian-copula-model..html#cb229-10" aria-hidden="true" tabindex="-1"></a>Xr.y2.any <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">2</span>]))</span>
<span id="cb229-11"><a href="the-gaussian-copula-model..html#cb229-11" aria-hidden="true" tabindex="-1"></a>Xr.y3.any <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">3</span>]))</span>
<span id="cb229-12"><a href="the-gaussian-copula-model..html#cb229-12" aria-hidden="true" tabindex="-1"></a>Xr.y4.any <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">4</span>]))</span>
<span id="cb229-13"><a href="the-gaussian-copula-model..html#cb229-13" aria-hidden="true" tabindex="-1"></a>Xr.y5.any <span class="ot">&lt;-</span> <span class="fu">filter_all</span>(Xr, <span class="fu">any_vars</span>(. <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]))</span></code></pre></div>
<p>All firms default in 5,935 cases out of 1,000,000.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="the-gaussian-copula-model..html#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(Xr.y5.all)</span></code></pre></div>
<pre><code>## [1] 5935</code></pre>
<p>Letâ€™s see the first 6 cases:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="the-gaussian-copula-model..html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Xr.y5.all), </span>
<span id="cb232-2"><a href="the-gaussian-copula-model..html#cb232-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">caption =</span> <span class="st">&quot;Cases in which all 10 firms default in five years.&quot;</span>, </span>
<span id="cb232-3"><a href="the-gaussian-copula-model..html#cb232-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-137">Table 3.23: </span>Cases in which all 10 firms default in five years.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-1.332</td>
<td align="right">-2.060</td>
<td align="right">-1.775</td>
<td align="right">-2.084</td>
<td align="right">-2.537</td>
<td align="right">-1.948</td>
<td align="right">-2.566</td>
<td align="right">-2.234</td>
<td align="right">-1.185</td>
<td align="right">-1.897</td>
</tr>
<tr class="even">
<td align="right">-1.935</td>
<td align="right">-1.393</td>
<td align="right">-2.217</td>
<td align="right">-1.527</td>
<td align="right">-1.609</td>
<td align="right">-1.794</td>
<td align="right">-1.680</td>
<td align="right">-1.235</td>
<td align="right">-2.578</td>
<td align="right">-1.188</td>
</tr>
<tr class="odd">
<td align="right">-1.575</td>
<td align="right">-1.215</td>
<td align="right">-1.974</td>
<td align="right">-1.116</td>
<td align="right">-1.557</td>
<td align="right">-2.516</td>
<td align="right">-1.933</td>
<td align="right">-2.999</td>
<td align="right">-2.253</td>
<td align="right">-2.294</td>
</tr>
<tr class="even">
<td align="right">-2.197</td>
<td align="right">-2.460</td>
<td align="right">-2.398</td>
<td align="right">-2.829</td>
<td align="right">-2.294</td>
<td align="right">-1.923</td>
<td align="right">-2.744</td>
<td align="right">-2.217</td>
<td align="right">-2.970</td>
<td align="right">-1.460</td>
</tr>
<tr class="odd">
<td align="right">-2.201</td>
<td align="right">-1.222</td>
<td align="right">-1.372</td>
<td align="right">-2.246</td>
<td align="right">-1.607</td>
<td align="right">-1.540</td>
<td align="right">-3.018</td>
<td align="right">-1.733</td>
<td align="right">-1.201</td>
<td align="right">-1.597</td>
</tr>
<tr class="even">
<td align="right">-2.106</td>
<td align="right">-2.355</td>
<td align="right">-2.526</td>
<td align="right">-2.044</td>
<td align="right">-2.002</td>
<td align="right">-2.416</td>
<td align="right">-1.833</td>
<td align="right">-2.936</td>
<td align="right">-2.041</td>
<td align="right">-2.080</td>
</tr>
</tbody>
</table>
<p>Verify that those cases default.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="the-gaussian-copula-model..html#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Xr.y5.all) <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]), <span class="at">caption =</span> <span class="st">&quot;Check if all of them default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-138">Table 3.24: </span>Check if all of them default.</caption>
<thead>
<tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
<th align="left">X8</th>
<th align="left">X9</th>
<th align="left">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p>At least one firm default in 497,987 out of 1,000,000.</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="the-gaussian-copula-model..html#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(Xr.y5.any)</span></code></pre></div>
<pre><code>## [1] 497987</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="the-gaussian-copula-model..html#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(Xr.y5.any), <span class="at">caption =</span> <span class="st">&quot;At least one firm default in five years.&quot;</span>,</span>
<span id="cb236-2"><a href="the-gaussian-copula-model..html#cb236-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div>
<table style="width:100%;">
<caption><span id="tab:unnamed-chunk-140">Table 3.25: </span>At least one firm default in five years.</caption>
<colgroup>
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">X2</th>
<th align="right">X3</th>
<th align="right">X4</th>
<th align="right">X5</th>
<th align="right">X6</th>
<th align="right">X7</th>
<th align="right">X8</th>
<th align="right">X9</th>
<th align="right">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-2.107</td>
<td align="right">-1.206</td>
<td align="right">-2.033</td>
<td align="right">-1.730</td>
<td align="right">-0.760</td>
<td align="right">-2.207</td>
<td align="right">-0.933</td>
<td align="right">-1.141</td>
<td align="right">-0.296</td>
<td align="right">-1.308</td>
</tr>
<tr class="even">
<td align="right">-1.346</td>
<td align="right">-2.023</td>
<td align="right">-1.661</td>
<td align="right">0.372</td>
<td align="right">-0.326</td>
<td align="right">0.874</td>
<td align="right">-0.328</td>
<td align="right">-0.315</td>
<td align="right">-0.712</td>
<td align="right">-0.266</td>
</tr>
<tr class="odd">
<td align="right">0.178</td>
<td align="right">-1.366</td>
<td align="right">1.120</td>
<td align="right">-1.732</td>
<td align="right">-0.582</td>
<td align="right">-0.820</td>
<td align="right">-0.058</td>
<td align="right">0.379</td>
<td align="right">-0.151</td>
<td align="right">0.294</td>
</tr>
<tr class="even">
<td align="right">1.263</td>
<td align="right">-0.132</td>
<td align="right">1.482</td>
<td align="right">-0.572</td>
<td align="right">0.485</td>
<td align="right">0.649</td>
<td align="right">-0.415</td>
<td align="right">-1.470</td>
<td align="right">0.669</td>
<td align="right">0.797</td>
</tr>
<tr class="odd">
<td align="right">-0.001</td>
<td align="right">-0.744</td>
<td align="right">-1.625</td>
<td align="right">0.673</td>
<td align="right">-0.665</td>
<td align="right">-0.442</td>
<td align="right">-1.272</td>
<td align="right">0.853</td>
<td align="right">-0.647</td>
<td align="right">-0.234</td>
</tr>
<tr class="even">
<td align="right">-0.180</td>
<td align="right">-1.380</td>
<td align="right">-0.383</td>
<td align="right">-0.292</td>
<td align="right">1.604</td>
<td align="right">1.021</td>
<td align="right">1.007</td>
<td align="right">0.079</td>
<td align="right">0.390</td>
<td align="right">-0.426</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="the-gaussian-copula-model..html#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>((<span class="fu">head</span>(Xr.y5.any) <span class="sc">&lt;</span> x.y[<span class="dv">5</span>]), <span class="at">caption =</span> <span class="st">&quot;Check which one(s) default.&quot;</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-141">Table 3.26: </span>Check which one(s) default.</caption>
<thead>
<tr class="header">
<th align="left">X1</th>
<th align="left">X2</th>
<th align="left">X3</th>
<th align="left">X4</th>
<th align="left">X5</th>
<th align="left">X6</th>
<th align="left">X7</th>
<th align="left">X8</th>
<th align="left">X9</th>
<th align="left">X10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
</tr>
<tr class="even">
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="left">FALSE</td>
<td align="left">TRUE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p>And the corresponding probabilities:</p>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="the-gaussian-copula-model..html#cb238-1" aria-hidden="true" tabindex="-1"></a>allR <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(<span class="fu">nrow</span>(Xr.y1.all), <span class="fu">nrow</span>(Xr.y2.all),</span>
<span id="cb238-2"><a href="the-gaussian-copula-model..html#cb238-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(Xr.y3.all), <span class="fu">nrow</span>(Xr.y4.all), <span class="fu">nrow</span>(Xr.y5.all)))</span>
<span id="cb238-3"><a href="the-gaussian-copula-model..html#cb238-3" aria-hidden="true" tabindex="-1"></a>atleastoneR <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">data.frame</span>(<span class="fu">nrow</span>(Xr.y1.any), <span class="fu">nrow</span>(Xr.y2.any),</span>
<span id="cb238-4"><a href="the-gaussian-copula-model..html#cb238-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">nrow</span>(Xr.y3.any), <span class="fu">nrow</span>(Xr.y4.any), <span class="fu">nrow</span>(Xr.y5.any)))</span>
<span id="cb238-5"><a href="the-gaussian-copula-model..html#cb238-5" aria-hidden="true" tabindex="-1"></a>resR <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(allR <span class="sc">/</span> n, atleastoneR <span class="sc">/</span> n)</span>
<span id="cb238-6"><a href="the-gaussian-copula-model..html#cb238-6" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(res02, resR)</span>
<span id="cb238-7"><a href="the-gaussian-copula-model..html#cb238-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(ans) <span class="ot">&lt;-</span> n.year</span>
<span id="cb238-8"><a href="the-gaussian-copula-model..html#cb238-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(ans) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;All (corr=0.2)&quot;</span>, <span class="st">&quot;At least one (corr=0.2)&quot;</span>,</span>
<span id="cb238-9"><a href="the-gaussian-copula-model..html#cb238-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;All (corr=rand)&quot;</span>, <span class="st">&quot;At least one (corr=rand)&quot;</span>)</span>
<span id="cb238-10"><a href="the-gaussian-copula-model..html#cb238-10" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(ans, <span class="at">caption =</span> <span class="st">&quot;Probability of default.&quot;</span>, </span>
<span id="cb238-11"><a href="the-gaussian-copula-model..html#cb238-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">row.names =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<table>
<caption><span id="tab:unnamed-chunk-142">Table 3.27: </span>Probability of default.</caption>
<colgroup>
<col width="8%" />
<col width="17%" />
<col width="27%" />
<col width="18%" />
<col width="28%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">All (corr=0.2)</th>
<th align="right">At least one (corr=0.2)</th>
<th align="right">All (corr=rand)</th>
<th align="right">At least one (corr=rand)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">year 1</td>
<td align="right">0.0e+00</td>
<td align="right">0.087276</td>
<td align="right">0.000018</td>
<td align="right">0.062795</td>
</tr>
<tr class="even">
<td align="left">year 2</td>
<td align="right">0.0e+00</td>
<td align="right">0.226406</td>
<td align="right">0.000163</td>
<td align="right">0.156515</td>
</tr>
<tr class="odd">
<td align="left">year 3</td>
<td align="right">0.0e+00</td>
<td align="right">0.386348</td>
<td align="right">0.000825</td>
<td align="right">0.267014</td>
</tr>
<tr class="even">
<td align="left">year 4</td>
<td align="right">1.2e-05</td>
<td align="right">0.543162</td>
<td align="right">0.002421</td>
<td align="right">0.382983</td>
</tr>
<tr class="odd">
<td align="left">year 5</td>
<td align="right">7.2e-05</td>
<td align="right">0.682148</td>
<td align="right">0.005935</td>
<td align="right">0.497987</td>
</tr>
</tbody>
</table>
<div style="page-break-after: always;"></div>
</div>
</div>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-3RFWK4ZPH8"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-3RFWK4ZPH8');
</script>
            </section>

          </div>
        </div>
      </div>
<a href="the-merton-model..html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="credit-var-example-24.7..html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
